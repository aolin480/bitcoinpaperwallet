<!doctype html>
<html>

<head>
    <title>Bitcoin Paper Wallet Generator</title>
    <meta charset="utf-8">

    <script type="text/javascript">
        // Basic initialization and switching for bitcoin vs. alternative cryptocurrencies
        function setCryptoCurrency(toThis) {
            window.currencyName = toThis;
            console.log(window)
            switch (toThis) {
                case 'Bitcoin':
                    window.networkVersion = 0x00;
                    window.privateKeyPrefix = 0x80;
                    window.WIFPrefix = '5';
                    window.compressedWIFPrefix = '[LK]';
                    break;
                case 'Ignition Coin':
                    window.networkVersion = 0x67;
                    window.privateKeyPrefix = 0x8a;
                    window.WIFPrefix = '5';
                    window.compressedWIFPrefix = 'M';
                    break;
                case 'Litecoin':
                    window.networkVersion = 0x30;
                    window.privateKeyPrefix = 0xb0;
                    window.WIFPrefix = '6';
                    window.compressedWIFPrefix = 'T';
                    document.title = 'Litecoin paper wallet generator';
                    break;
                case 'Dogecoin':
                    window.networkVersion = 0x1e;
                    window.privateKeyPrefix = 0x9e;
                    window.WIFPrefix = '6';
                    window.compressedWIFPrefix = 'Q';
                    document.title = 'Dogecoin paper wallet generator. Wow! Many coin. Such shiny.';
                    break;
                case 'Testnet':
                    window.networkVersion = 0x6F;
                    window.privateKeyPrefix = 0xEF;
                    window.WIFPrefix = '9';
                    window.compressedWIFPrefix = 'c';
                    document.title = 'Bitcoin TESTNET paper wallet generator';
                    break;
                default:
                    alert('Invalid cryptocurrency "' + toThis + '" at initialization. Defaulting to Bitcoin.');
                    setCryptoCurrency('Bitcoin');
            } // eof switch
            return (true);
        }

        function getParameterByName(name) {
            name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                results = regex.exec(location.search);
            return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }

        var myDesign = getParameterByName('design');
        window.suppliesURL = 'https://bitcoinpaperwallet.com/?p=' + myDesign + '#purchase';

        switch (myDesign) {
            case 'alt-litecoin':
                setCryptoCurrency('Litecoin');
                break;
            case 'alt-dogecoin':
                setCryptoCurrency('Dogecoin');
                break;
            case 'alt-ignitioncoin':
                setCryptoCurrency('Ignition Coin');
                break
            case 'alt-testnet':
                setCryptoCurrency('Testnet');
                break;
            default:
                setCryptoCurrency('Ignition Coin');
                window.suppliesURL = 'https://bitcoinpaperwallet.com/#purchase'; // remove special currency flag
        }
    </script>

    <script type="text/javascript" src="js/Array.map.js"></script>
    <script type="text/javascript" src="js/cryptojs/crypto.js"></script>
    <script type="text/javascript" src="js/cryptojs/SHA256.js"></script>
    <script type="text/javascript" src="js/cryptojs/PBKDF2.js"></script>
    <script type="text/javascript" src="js/cryptojs/HMAC.js"></script>
    <script type="text/javascript" src="js/cryptojs/AES.js"></script>
    <script type="text/javascript" src="js/cryptojs/BlockModes.js"></script>
    <script type="text/javascript" src="js/cryptojs/RIPEMD-160.js"></script>
    <script type="text/javascript" src="js/randomGenerator.js"></script>
    <script type="text/javascript" src="js/ecdsa.js"></script>
    <script type="text/javascript" src="js/bigNumberLibrary.js"></script>
    <script type="text/javascript" src="js/qrcode.js"></script>
    <script type="text/javascript" src="js/bitcoin.js"></script>
    <script type="text/javascript" src="js/node-scrypt-js.js"></script>
    <script type="text/javascript" src="js/user-agent-parser.js"></script>
    <script type="text/javascript" src="js/jsqrcode.js"></script>

    <link rel="stylesheet" href="css/styles.css">

</head>

<body onclick="SecureRandom.seedTime();" onmousemove="ninja.seeder.seed(event);" ontouchmove="ninja.seeder.seed(event);" onLoad="setDesign(ninja.getQueryString()['design'], true, ninja.getQueryString()['lang']); guessPrinterSettings(); ">
    <div id="busyblock">
        <div class="background"></div>
        <div class="dialog dialog-narrow">
            <h2>One moment please...</h2>
            <p>Encrypting your wallet. This may take up to <u>several minutes</u> on a slower computer.</p>
        </div>
    </div>
    <div id="busyblock_decrypt">
        <div class="background"></div>
        <div class="dialog dialog-narrow">
            <h2>One moment please...</h2>
            <p>Decrypting the private key. This may take up to <u>several minutes</u> on a slower computer.</p>
        </div>
    </div>
    <div id="main">
        <div id="logoback">
            <div id="culturemenu">
                <!--
              <span><a href="?culture=en" id="cultureen" class="selected">English</a></span> | 
              <span><a href="?culture=es" id="culturees">Español</a></span> | 
              <span><a href="?culture=fr" id="culturefr">Français</a></span> -->
                &nbsp;
            </div>
            <div id="tagline">Open Source JavaScript
                <script type="text/javascript">
                    document.write(window.currencyName);
                </script> Paper Wallet Generator <span>Updated Sep 22, 2017</span></div>
            <div id="tagsite">For help, security tips, or wallet making supplies visit <a href="https://bitcoinpaperwallet.com">bitcoinpaperwallet.com</a></div>
            <div id="tagwarning"></div>
            <div id="seedpoolarea">
                <textarea rows="16" cols="62" id="seedpool"></textarea>
            </div>

            <div class="menu" id="menu">
                <div id="printeradjust">
                    Zoom:
                    <a href="#" onClick="printZoom(-1); return(false);"><span>-</span></a>
                    <input name="printerzoom" id="printerzoom" size="2" value="5" onChange="updateCalibrationInfo();" /><a href="#" onClick="printZoom(1); return(false);"><span>+</span></a> &nbsp; Horizontal Shift:
                    <a href="#" onClick="printShift(-1); return(false);"><span>-</span></a>
                    <input name="printershift" id="printershift" size="2" value="5" onChange="updateCalibrationInfo();" /><a href="#" onClick="printShift(1); return(false);"><span>+</span></a>
                </div>

                <div class="tab selected" id="landwallet" onClick="ninja.tabSwitch(this);">Instructions</div>
                <div class="tab" id="calibratewallet" onClick="ninja.tabSwitch(this);">1. Calibrate</div>
                <div class="tab" id="paperwallet" onClick="ninja.tabSwitch(this);">2. Print Front</div>
                <div class="tab" id="backwallet" onClick="ninja.tabSwitch(this);">3. Print Back</div>
                <div class="tab" id="foldwallet" onClick="ninja.tabSwitch(this);">4. Cut, Fold &amp; Seal</div>
                <div class="tab" id="detailwallet" onClick="ninja.tabSwitch(this);">&#x2713; Validate or Decrypt</div>
            </div>

        </div>
        <!-- end logoback -->

        <div id="generate">
            <div id="generatelabelmovemouse">

                <div id="rightArea">

                    <div id="progress-bar" class="fullyRounded">
                        <div id="progress-bar-percentage" class="fullyRounded" style="width: 1%"><span id="mousemovelimit"> &nbsp; </span></div>
                    </div>

                    <div id="seedSkipper">
                        <a href="#" class="nicerButton" style="width: 100px;" onClick="ninja.seeder.seedCount = ninja.seeder.seedLimit; ninja.seeder.seed();">Skip &raquo;</a>
                        <br />
                        <p>You may safely skip this step if you do not need to use the random wallet generator.</p>
                    </div>
                </div>

                Secure random number generation requires that you provide some unpredictable data, also called "entropy".
                <br />
                <blink>Please move your mouse around and/or type random keystrokes into this box:</blink>
                <input type="text" size="4" id="generatekeyinput" onKeyPress="ninja.seeder.seed(event);" />

                <p id="generatelabelbitcoinaddress">
                    <div id="seedpooldisplay"></div>
                </p>
            </div>
        </div>

        <div id="wallets">

            <div id="landarea" class="walletarea">
                <div id="landcommands" class="commands">
                    &nbsp;
                </div>
                <div class="instructionsarea">
                    <div class="notes">
                        <h1><span id="instructions0">Welcome! Let's print out a beautiful and secure wallet for your
                                <script type="text/javascript">
                                    document.write(window.currencyName);
                                </script>s.</span></h1>
                        <span id="instructions1"><em>Here's an overview of what will happen, step by step.</em></span>
                        <br>
                        <br>
                        <div style="float: right; width: 410px; padding-left: 30px; margin-left: 20px; border-left: 4px solid #EEE;">

                            <img id="designPreview" src="images/finished-sample-sealed.jpg" width="400" height="203" alt="Sealed Wallet">

                            <h2><span id="instructions01">Basic security checklist:</span></h2>
                            <ul>
                                <li>
                                    <script language="javascript">
                                        switch (window.location.protocol) {
                                            case 'http:':
                                            case 'https:':
                                                document.write('<span style="color: #990000;">&times; You appear to be running this generator off of a live website, which is not recommended for creating valuable wallets. Instead, use the download link at the bottom of this page to download the ZIP file from GitHub and run this generator offline as a \'local\' HTML file.</span>');
                                                break;
                                            case 'file:':
                                                document.write('<span style="color: #009900;">&#10004; You are running this generator from your own download.</span><br />Tip: Make 100% sure you are offline by trying <a href="https://google.com" target="_blank">google.com</a></span>');
                                                break;
                                            default:
                                        }
                                    </script>

                                </li>
                                <li>
                                    <script language="javascript">
                                        if (window.crypto && window.crypto.getRandomValues) {
                                            document.write('<span style="color: #009900;">&#10004; Your browser is capable of generating cryptographic strength random keys using window.crypto.getRandomValues</span>');
                                        } else {
                                            document.write('<span style="color: #990000;">&times; Your browser does NOT support window.crypto.getRandomValues(), which is important for generating the most secure random numbers possible. Please use a more modern browser.</span>');
                                        }
                                    </script>
                                </li>
                                <li><strong>?</strong> Are you using a secure operating system installation guaranteed to be free of spyware and viruses, for example, an <a href="#" onClick="window.open('https://bitcoinpaperwallet.com/ubuntu-linux-live-bootable-cd/', '_blank'); return false;">Ubuntu LiveCD?</a></li>
                            </ul>

                            <p><a href="https://bitcoinpaperwallet.com/#security" target="_blank">More security tips and answers to frequently asked questions &raquo;</a></p>

                        </div>
                        <span id="instructions2">
                            <p style="margin-top: 0;"><strong>Change your wallet's design, language, or cryptocurrency here:</strong>
                                <select name="designPicker" id="designPicker" style="font-size: 12px;" onChange="setDesign(this.value, false);">
                                    <option value="default">Standard Bitcoin Design</option>
                                    <option value="bitcoincash">Bitcoin Cash Design</option>
                                    <option value="blackwhite">Black &amp; White Bitcoin</option>
                                    <option value="holiday">Holiday / Christmas Bitcoin (English)</option>
                                    <option value="chinese-new-year">Chinese New Year Bitcoin (Simplified Chinese)</option>
                                    <option value="traditional-chinese-new-year">Chinese New Year Bitcoin (Traditional Chinese)</option>
                                    <option value="hobbit">"HobBitcoin" :)</option>
                                    <option value="custom">Your own custom Bitcoin design</option>
                                    <option value="default">--- Other Cryptocurrencies ---</option>
                                    <option value="alt-litecoin">Litecoin LTC</option>
                                    <option value="alt-dogecoin">Dogecoin DOGE</option>
                                    <option value="counterparty">Counterparty XCP</option>
                                    <option value="alt-testnet">"Testnet"</option>
                                </select>
                                <select name="langPicker" id="langPicker" style="font-size: 12px; display: inline;" onChange="setDesign('default', false, this.value);">
                                    <option value="english">English</option>
                                    <option value="chinese">Chinese</option>
                                    <option value="traditional-chinese">Chinese (Traditional)</option>
                                    <option value="czech">Czech</option>
                                    <option value="danish">Danish</option>
                                    <option value="dutch">Dutch</option>
                                    <option value="french">French</option>
                                    <option value="german">German</option>
                                    <option value="hebrew">Hebrew</option>
                                    <option value="italian">Italian</option>
                                    <option value="japanese">Japanese</option>
                                    <option value="polish">Polish</option>
                                    <option value="portuguese">Portuguese</option>
                                    <option value="russian">Russian</option>
                                    <option value="spanish">Spanish</option>
                                    <option value="swedish">Swedish</option>
                                    <option value="welsh">Welsh</option>
                                </select>
                            </p>
                            <strong>Step 1: Calibrate Printer</strong><br> Before printing out a wallet you may need to calibrate your output using the <em>zoom</em> and <em>horizontal&nbsp;shift</em> adjustments to account for your particular browser and printer combination. Otherwise, your wallet's back side may not line up with the front side.</span>
                        <br>
                        <br>
                        <span id="instructions3"><strong>Step 2: Print Front</strong><br> Next you will print out the front side of your wallet. The public address and private key will be random-generated, <em>or</em> you can supply your own key by rolling dice, shuffling cards, etc. You may also duplicate an existing paper wallet or provide a "vanity" address if you have one. Tip: If you are printing several wallets, it's possible to <a href="https://bitcoinpaperwallet.com/printing-and-paper-tips/" target="_blank">print two per page</a>.</span>
                        <br>
                        <br>
                        <span id="instructions4"><strong>Step 3: Print Back</strong><br> Flip the front page over and put it back in your printer. This isn't just for good looks! The reverse design includes important tamper-resistant safeguards.</span>
                        <br>
                        <br>
                        <span id="instructions5"><strong>Step 4: Cut, Fold, Seal &amp; Fund</strong><br> Find your scissors! The final step is to cut out your wallet, fold it, and seal it with tamper-evident <a href="#" onClick="window.open(window.suppliesURL, '_blank'); return false;">hologram stickers</a> or at least opaque (light-blocking) tape. Now you're ready to transfer funds from your online holdings to your new wallet.</span>
                        <br>
                        <br>
                        <span><a href="https://www.youtube.com/watch?v=a47rrYBWjWQ" target="_blank" class="nicerButton" style="width: 400px;">90 second tutorial video on YouTube &raquo;</a></span>
                        <br />
                        <br />
                        <span><a href="#" onClick="window.open(window.suppliesURL, '_blank'); return false;" class="nicerButton" style="width: 400px; margin-bottom: 10px;">Order hologram stickers / zip bags / Ubuntu CD &raquo;</a></span>

                    </div>
                </div>
            </div>
            <!-- end landarea -->

            <div id="calibratearea" class="walletarea">
                <div class="commands">
                    <div id="calibratecommands">
                        <p id="calibrateinstructions" class="instructions">The calibration step helps line up the front and back sides of your printout. <a href="#" onClick="doPrint('calibration');">Print out this page</a> in LANDSCAPE ORIENTATION (wide instead of tall.) Based on the results, adjust the "zoom" and "horizontal shift" in the upper-right corner of this page and keep printing tests until:
                            <br />
                            <br /> (1) Your printed ruler is horizontally centered on the page, leaving equal margins on the left and right sides of the page. (INCREASE the horizontal shift to push the ruler to the right.)
                            <br /> (2) Your printed ruler is approximately the same size as a real ruler. Smaller by up to 1 inch is fine. (REDUCE the zoom to increase the ruler size.)
                            <br />
                            <br />
                            <br /> What settings worked best for you? <a href="https://bitcoinpaperwallet.com/feedback/" target="_blank">Feedback form &raquo;</a></p>
                        <span class="print">
                            <a href="#" class="nicerButton" onClick="doPrint('calibration');">Print Calibration Test</a>
                        </span>
                    </div>
                </div>

                <div id="calibrationinfo">Zoom / Shift : Default</div>
                <img id="calibratesvg" class="calibratesvg" src="./images/calibrate-300dpi.jpg">
                <div id="browserinfo"></div>
                <!-- this gets set onLoad -->

            </div>
            <!-- end calibratearea -->

            <div id="paperarea" class="walletarea">
                <div id="papercommands" class="commands">
                    <div style="display: none;">
                        <!-- no need to reveal these -->
                        <span><label id="paperlabelhideart">Hide Art?</label> <input type="checkbox" id="paperart" onChange="ninja.wallets.paperwallet.toggleArt(this); " /></span>
                        <span><label id="paperlabeladdressesperpage">Addresses per page:</label> <input type="text" id="paperlimitperpage" /></span>
                        <span><label id="paperlabeladdressestogenerate">Addresses to generate:</label> <input type="text" id="paperlimit" /></span>
                    </div>

                    <div id="keyButtons" style="display: block; float: left;">
                        <input type="button" id="papergenerate1" value="RANDOM GENERATE NEW WALLET" onClick="ninja.wallets.paperwallet.build(document.getElementById('paperlimit').value * 1, document.getElementById('paperlimitperpage').value * 1, !document.getElementById('paperart').checked, document.getElementById('paperpassphrase').value); printCounter=0;" />

                        <input type="button" id="papergenerate2" value="Enter my own key, dice rolls, brain wallet, etc..." onClick="ninja.wallets.paperwallet.toggleVanityField(true);" />
                    </div>

                    <div id="selfinfo" style="display: none; position: absolute; top: 15px;">

                        <b class="helpTitle">If you are making a paper wallet for a <a href="https://en.bitcoin.it/wiki/Vanitygen" target="_blank">vanity address</a>, or duplicating an existing paper wallet:</b>
                        <br />
                        <br /> In this case, simply enter your private key in Wallet Import Format (or scan it using the "validate" feature on this web page.) WIF keys always begin with the number 5 and look something like this: '5JnwJNC7q3...' <em>The public address, e.g. '1vanityABC456...' is automatically calculated using the private key, so you only need to provide the private key.</em>

                        <div class="helpDivider"></div>

                        <b class="helpTitle">If you want to roll dice or shuffle a deck of cards to generate a key:</b>
                        <br />
                        <br /> Maybe you don't trust that this software (or computers in general) can generate sufficiently random numbers. In this case, you can supply your own random data points from virtually any source. For example, you can roll a six sided die at least 62 times and enter each roll in sequence, e.g. '<strong>15249385616</strong>...' Or, you can mix up a deck of 52 playing cards (shuffle at least 10 times!) and enter at least the top 31 cards in this format: <strong>5S10HAC</strong>-... (where <strong>5S</strong> = 5 of Spades, <strong>10H</strong> = 10 of Hearts, <strong>AC</strong> = Ace of Clubs, etc.)
                        <br />
                        <br />
                        <em>No special formatting is required</em>. Just type in a great deal of (truly) random text from any source, and whatever you supply will be SHA256 hashed and converted into a private key and public address.

                        <div class="helpDivider"></div>

                        <b class="helpTitle">If you want to make a paper wallet which can <em>also</em> be accessed using a passphrase (AKA a "brain wallet"):</b>
                        <br />
                        <br /> You can make a so-called "brain wallet" by supplying a VERY secure passphrase like '1852 Adobe Cloud SMASH fuzzy steamzonk'. <em>Be extremely careful doing this because a wallet generated using an insecure passphrase is virtually guaranteed to have its balance stolen!</em>.
                        <br />
                        <br />The resulting paper wallet will still have an ordinary crypto-looking private key and public address, but you will <em>also</em> be able to retrieve your wallet contents by entering your passphrase into the 'verify' tab of this service or a similar service.
                        <br />
                        <br />
                        <strong>Note:</strong> supplying a brain wallet passphrase is different from BIP38-encrypting your wallet with a passphrase.
                        <br />
                        <br />
                        <a href="#" class="nicerButton" onClick="document.getElementById('selfinfo').style.display='none'; return(false);">OK</a>
                    </div>

                    <div id="supplyKeys" style="display: none; float: left;">
                        <p style="padding: 0; margin: 0;">
                            <input placeholder="Enter WIF private key (or brain wallet, dice rolls, shuffled cards, etc.)" autocomplete="off" id="suppliedPrivateKey" name="suppliedPrivateKey" spellcheck="false" style="font-family: ubuntu_mono_bold, 'Courier New', Courier, monospace;" />&nbsp;
                            <input type="button" id="papergenerate3" value="Apply &raquo;" onClick="testAndApplyVanityKey();" />
                        </p>
                        <p style="margin: 10px 0 0 0; padding:0;">
                            <div style="float: right;">
                                <input type="button" id="papergenerate4" value="&laquo; Back to random generator" onClick="ninja.wallets.paperwallet.toggleVanityField(false);" />
                            </div>

                            <div style="float: left; font-size: 12px;"><a href="#" onClick="document.getElementById('selfinfo').style.display='block'; return(false);"><strong>Help me!</strong> (How to enter keys, roll dice...)</a></div>
                        </p>
                    </div>

                    <div id="paperadvancedcommands">
                        <input type="checkbox" id="paperencrypt" onChange="ninja.wallets.paperwallet.toggleEncryptSettings(this.checked);" />BIP38 Encrypt
                        <div id="paperencryptstatus" class="hide">
                            <div id="paperencryptpassphrase"></div>
                            <input type="button" value="Change Passphrase" onClick="ninja.wallets.paperwallet.toggleEncryptSettings(true);" style="font-size: 10px;">
                        </div>
                    </div>

                    <div id="paperbip38settings">
                        <div class="background"></div>
                        <div class="dialog instructionsarea">
                            <p style="float: right;"><a href="https://bitcoinpaperwallet.com/wallet-tutorial-add-withdraw-funds/" target="_blank">Help / Instructions &raquo;</a></p>
                            <h2>About "BIP38" Encryption</h2>
                            <p>The advantage with BIP38 is that if your paper wallet is stolen or compromised, the private key cannot be recovered without your password. <em>Even a very short password adds a strong degree of protection</em>. However, if you encrypt your private key with BIP38 and you lose your password, it will be impossible for you to recover the funds you have sent to this wallet.</p>
                            <p>Also, note that not all
                                <script type="text/javascript">
                                    document.write(window.currencyName);
                                </script> wallet applications or web services are able to import or "sweep" BIP38 encrypted keys. In this case, you will have to use the <strong>Validate or Decrypt</strong> feature on this webpage to reveal the unencrypted Wallet Import Format (WIF) key as an intermediate step before sweeping the balance.</p>

                            <p style="color: red;">WARNING: Before sending any funds to a BIP38-encrypted wallet, first do a test make sure you are able to decrypt the printed private key back to ordinary WIF format.</p>
                            <p>Unless you have a strong understanding of the BIP38 encryption and decryption workflow, <strong>click cancel</strong>, print your paper wallet without BIP38, and just keep it safe and hidden like you would jewels or cash.
                            </p>
                            <p>
                                <button id="paperbip38activate" disabled onClick="ninja.wallets.paperwallet.toggleEncryptSettings(false);">TURN ON BIP38 ENCRYPTION</button>
                                <label id="paperlabelBIPpassphrase" for="paperpassphrase"><strong>using password / passphrase:</strong></label>
                                <input type="text" id="paperpassphrase" autocomplete="off" onKeyUp="document.getElementById('paperbip38activate').disabled = this.value.length < 3" onChange="this.value = this.value.toString().replace(/^\s+|\s+$/g, '');" />
                            </p>
                            <p>
                                <button onClick="ninja.wallets.paperwallet.toggleEncryptSettings(false, true);">CANCEL</button>
                            </p>
                        </div>
                    </div>

                    <span class="print">
                        <a href="#" class="nicerButton" onClick="doPrint('generate');">Print Wallet Front</a>
                    </span>
                    <br clear="all" />
                </div>
                <div id="paperkeyarea"></div>
            </div>
            <!-- end paperarea -->

            <div id="backarea" class="walletarea">
                <div class="commands">
                    <div id="backcommands">
                        <p id="backinstructions" class="instructions highlighted"><strong>Reload the front page into your printer first.</strong> Note: The back design is intentionally larger than the front side. Use the front side as your guide when cutting out your wallet.</p>

                        <span class="print"><a href="#" class="nicerButton" onClick="doPrint();">Print Wallet Back</a></span>
                        <br clear="all" />
                    </div>

                    <div id="backTextControl" style="font-size: 12px;">
                        <div style="float: left; width: 375px; text-align: right;">
                            Denomination:
                            <select id="backDenominationSelect" onChange="setDenomination(this.value);">
                                <option value="">*** None ***</option>
                                <option value="10 BTC">10 BTC</option>
                                <option value="5 BTC">5 BTC</option>
                                <option value="2 BTC">2 BTC</option>
                                <option value="1 BTC">1 BTC</option>
                                <option value="50000 Bits">50000 Bits</option>
                                <option value="10000 Bits">10000 Bits</option>
                                <option value="5000 Bits">5000 Bits</option>
                                <option value="1000 Bits">1000 Bits</option>
                                <option value="500 Bits">500 Bits</option>
                                <option value="100 Bits">100 Bits</option>
                                <option value="50000 mBTC">50000 mBTC</option>
                                <option value="10000 mBTC">10000 mBTC</option>
                                <option value="5000 mBTC">5000 mBTC</option>
                                <option value="1000 mBTC">1000 mBTC</option>
                                <option value="500 mBTC">500 mBTC</option>
                                <option value="100 mBTC">100 mBTC</option>
                                <option value="50 mBTC">50 mBTC</option>
                                <option value="20 mBTC">20 mBTC</option>
                                <option value="10 mBTC">10 mBTC</option>
                                <option value="5 mBTC">5 mBTC</option>
                                <option value="1 mBTC">1 mBTC</option>
                                <option value="other">Other...</option>
                            </select>
                            <div id="backDenominationOther" style="display: none;">
                                <input id="backDenominationOtherAmount" maxlength="5" size="6" value="1" onChange="setDenomination('other');">
                                <select id="backDenominationOtherUnit" onChange="setDenomination('other');">
                                    <option value="BTC">BTC</option>
                                    <option value="mBTC">mBTC</option>
                                    <option value="&mu;BTC">&mu;BTC</option>
                                    <option value="bits">bits</option>
                                </select>
                            </div>
                            <!-- end backDenominationOther -->
                        </div>

                        <div style="float: left; margin: 0 0 0 80px;">
                            Message:
                            <select id="backTextChooser" onChange="
                       		var toggleBackLongText = (this.value == 'instructions' ? 'block' : 'none'); 				
                       		var toggleBackCustomMessage = (this.value == 'message' ? 'block' : 'none'); 				
                           document.getElementById('backLongText').style.display=toggleBackLongText;
                           document.getElementById('backCustomMessage').style.display=toggleBackCustomMessage;">
                                <option value="instructions">Instructions</option>
                                <option value="message">Write your own...</option>
                                <option value="">Blank</option>
                            </select>

                        </div>

                        <div style="float: left; margin: 0 0 0 50px;">
                            <input type="checkbox" checked id="backTextCheckbox2" onClick="var toggleStatus = (this.checked ? 'block' : 'none'); 				
                              document.getElementById('backAmount').style.display=toggleStatus;
                              document.getElementById('backDate').style.display=toggleStatus;
                              document.getElementById('backNotes').style.display=toggleStatus;
                              document.getElementById('backLines').style.display=toggleStatus;"> Include notes area
                        </div>
                    </div>
                    <!-- backTextControl -->
                </div>
                <!-- end commands -->

                <div id="backText">
                    <div id="backSeal">
                        <p id="backSealBig">1000</p>
                        <p id="backSealSmall">mBTC</p><img src="images/front-seal.png" width="105" height="78"></div>

                    <div id="backPaperWallet"></div>
                    <div id="backAmount"></div>
                    <div id="backDate"></div>
                    <div id="backNotes"></div>
                    <div id="backLines">
                        <p>&nbsp;</p>
                        <p>&nbsp;</p>
                        <p>&nbsp;</p>
                        <p>&nbsp;</p>
                        <p>&nbsp;</p>
                    </div>

                    <div id="backCustomMessage">
                        <div id="backCustomMessageContent" style="display: none;"></div>
                        <textarea id="backCustomMessageEntry" placeholder="Enter message here" onChange="document.getElementById('backCustomMessageContent').innerHTML=this.value.replace(/(?:\r\n|\r|\n)/g, '<br />');"></textarea>
                    </div>
                    <div id="backLongText">
                        <ul>
                            <li id="backInst1"></li>
                            <li id="backInst2"></li>
                            <li id="backInst3"></li>
                            <li id="backInst4"></li>
                        </ul>
                    </div>
                    <!-- end backLongText -->
                </div>
                <!-- end backText -->

                <img id="backsvg1" class="backsvg" src="./images/back-300dpi.jpg">
            </div>
            <!-- end backarea -->

            <div id="foldarea" class="walletarea">
                <div id="foldcommands" class="commands">
                    &nbsp;
                </div>
                <div class="instructionsarea">
                    <h1><span id="instructions21">How to cut &amp; fold your 2-sided wallet:</span></h1>
                    <div class="notes">

                        <div style="float: right; margin: 0 0 20px 30px; padding-left: 30px; border-left: 4px solid #eee;">
                            <img src="images/finished-folds.png" width="355" height="144" alt="Folding Diagram">
                            <br />
                            <br />
                            <img src="images/finished-sample.jpg" width="400" height="203" alt="Sample Wallet">
                            <br />
                            <br />
                            <img src="images/finished-sample-bagged.jpg" width="400" height="203" alt="Sealed Wallet">
                        </div>

                        <span id="instructions22">Cut out your wallet <em>using the front side as a guide, not the back!</em>

                            The design on the reverse side is intentionally larger than the front side so that back design will "bleed" to the edges even if your front and back sides are somewhat misaligned.
                            <br /><br /> Now fold the more narrow private key area in half, and then over again as indicated by the dotted lines in this diagram. The "butterfly" shape is time-consuming to cut out, but <em>without all those cuts and angles, someone can reveal your private key without removing the tape</em>!</span>
                        <br />
                        <br />
                        <span id="instructions23">The final wallet will be a rectangle shape with the more narrow private key area folded over it.</span>
                        <br />

                        <br />
                        <span id="instructions13">Seal your wallet by placing two strips of sturdy <strong>light-blocking</strong> tape over the top and bottom edges of the private (folded) area. A zip-seal bag will keep it safe from moisture, which is especially important when using an inkjet printer.</span>
                        <br />
                        <br />
                        <a href="#" onClick="window.open(window.suppliesURL, '_blank'); return false;" class="nicerButton" style="width: 400px;">Purchase hologram stickers and/or zip-sealing bags &raquo;</a>

                        <br />
                        <br />

                        <h1><span id="instructions16">How to add funds to your wallet:</span></h1>

                        <span id="instructions17">Send
                            <script type="text/javascript">
                                document.write(window.currencyName);
                            </script>s to the address (or QR code) where your wallet says "PUBLIC ADDRESS".</span>
                        <br />
                        <br />

                        <h1><span id="instructions18">How to withdraw funds from your wallet:</span></h1>

                        <span id="instructions19">You should expect to withdraw the entire balance of the wallet by importing it (or "sweeping" it) to a live wallet, e.g. a Bitcoin wallet application or online service like blockchain.info or coinbase.com.
                            <br />
                            <br />
                            <strong>If you elected to BIP38-encrypt your wallet</strong>, you may need to recover your unencrypted WIF "Wallet Import Format" private key by using the "validate" tab on this web page.
                            <br />
                            <br />
                            <h1><span id="instructions20">Tips &amp; FAQ's</span></h1>
                        &bull; <a href="https://bitcoinpaperwallet.com/printing-and-paper-tips/" target="_blank">What kind of printer and paper to use &raquo;</a>
                        <br /> &bull; <a href="https://bitcoinpaperwallet.com/wallet-tutorial-add-withdraw-funds/" target="_blank">Adding to and spending from a paper wallet &raquo;</a>
                        <br /> &bull; <a href="https://bitcoinpaperwallet.com/bip38-password-encrypted-wallets/" target="_blank">How and when to use BIP38 encryption &raquo;</a>
                        <br />

                        </span>

                    </div>
                </div>
            </div>
            <!-- end landarea -->

            <div id="detailarea" class="walletarea">

                <div id="detailcommands" class="commands">
                    &nbsp;
                </div>
                <div class="instructionsarea">
                    <h1>Validate or decrypt private key</h1>
                    <div style="width: 45%; float: left; padding: 0 15px; border-right: 3px solid #ccc;">
                        <p><em>This feature works for private keys made here as well as those generated using any other Bitcoin service or software, e.g. bitaddress.org or brainwallet.org</em></p>
                        <p><strong>Enter or <a onClick="ninja.wallets.detailwallet.qrscanner.start()">scan</a> any private key to verify that the key is valid</strong> and show its corresponding public key. If your private key validates, then you may be reassured that you will able to retrieve any funds sent to that wallet.</p>
                        <p><strong>To duplicate or BIP38-encrypt any paper wallet</strong>, just validate its private key and click the "Use these details to print a paper wallet" button.</p>
                        <p><strong>Is your wallet BIP38 encrypted?</strong> If so, you can use this form to decrypt your private key and recover the standard Wallet Import Format (WIF) key suitable for wallet software and services that don't directly support BIP38 importing.</p>
                        <p><strong>You may also type in a "brain wallet" passphrase</strong> to see the corresponding SHA256 hashed keys.</p>
                    </div>
                    <div style="width: 45%; float: left; padding: 0 15px;">
                        <span class="qrinput">
                            <input type="text" id="detailprivkey" value="" placeholder="Enter a private key, or click the QR icon to scan" autocomplete="off" onFocus="this.select();" onKeyPress="if (event.keyCode == 13) ninja.wallets.detailwallet.viewDetails();" />
                            <span onClick="ninja.wallets.detailwallet.qrscanner.start()"></span>
                        </span>
                        <div id="paperqrscanner">
                            <div class="background"></div>
                            <div id="mainbody" class="dialog instructionsarea">
                                <p style="float: right;"><a href="https://bitcoinpaperwallet.com/how-to-scan-qr-codes-with-camera/" target="_blank" style="font-family: 'Lucida Console', Monaco, monospace;">Help / Instructions &raquo;</a></p>
                                <h2>Scan QR code using your camera</h2>
                                <div id="paperqrnotsupported" style="color: red" class="hide">Sorry, but your web browser does not support the HTML5 camera controls. Try using a recent version of Firefox (recommended), Chrome or Opera.</div>
                                <div id="paperqrpermissiondenied" style="color: red" class="hide">
                                    <p>Permission denied. Your browser should display a message requesting access to your camera. Please click the "Allow" button to enable the camera.</p>
                                    <p>If you are using Chrome and you launched this generator by opening the HTML file from your own computer "locally", you may need to launch Chrome from the command line and specify the <a href="https://bitcoinpaperwallet.com/how-to-scan-qr-codes-with-camera/" target="_blank" style="font-family: 'Lucida Console', Monaco, monospace;">--allow-file-access-from-files</a> flag. Or you can set up a local web server (Apache) and run this generator via http://127.0.0.1... or, give up and just use Firefox.</p>

                                </div>
                                <div id="paperqrerror" style="color: red"></div>
                                <div id="paperqroutput"></div>
                                <button onClick="ninja.wallets.detailwallet.qrscanner.stop()">Cancel</button>
                            </div>
                        </div>
                        <br />
                        <span><input type="button" id="detailview" value="Validate / Decrypt" onClick="ninja.wallets.detailwallet.viewDetails();" /></span>
                        <div class="row extra">
                            <span><label id="detailkeyformats">Supported formats: WIF, WIFC, HEX, B64, B6, MINI, BIP38, "Brain Wallet"</label></span>
                        </div>
                        <div id="detailbip38commands">
                            This "6P..." private key is BIP38-encrypted.
                            <br />
                            <label id="detaillabelpassphrase">Please type in passphrase below:</label>
                            <br />
                            <span><input type="text" id="detailprivkeypassphrase" value="" onFocus="this.select();" onKeyPress="if (event.keyCode == 13) ninja.wallets.detailwallet.viewDetails();" /></span>
                            <span><input type="button" id="detaildecrypt" value="Decrypt BIP38" onClick="ninja.wallets.detailwallet.viewDetails();" /></span>
                        </div>
                    </div>
                    <div style="clear: both;"></div>

                    <div id="detailkeyarea" class="hide">
                        <div class="notes">
                            <h1>Public and private details for:<br /><span id="detailkeyareakey"></span></h1>
                            <p>
                                <button onClick="ninja.wallets.detailwallet.loadInPaperWallet()">Use these details to print a paper wallet</button>
                            </p>
                            <span id="detaillabelnote1">Use the <strong>Public Address</strong> to receive funds or check your balance online. The <strong>Private Key WIF</strong> is a code that needs to be keep secret since it can be used to spend any funds that have been sent to the corresponding public key. Keys can be encoded in a number of different formats. The most popular encoding formats (WIF, WIFC, HEX, B64) are shown below.</span>
                            <br />
                        </div>
                        <div class="pubqr">
                            <div class="item">
                                <span class="label" id="detaillabelbitcoinaddress"><strong style="font-size: 150%;">Public
                                        <script type="text/javascript">
                                            document.write(window.currencyName);
                                        </script> Address</strong></span>
                                <div id="detailqrcodepublic" class="qrcode_public"></div>
                                <span class="output" id="detailaddress"></span>
                            </div>

                            <div class="item right" style="display:block;" id="compressedpicker">
                                <a href="#" onClick="document.getElementById('compressed1').style.display='block'; document.getElementById('compressed2').style.display='block';  document.getElementById('compressedpicker').style.display='none'; return(false);">Display compressed format keys?</a>
                            </div>

                            <div class="item right" style="display: none;" id="compressed1">
                                <span class="label" id="detaillabelbitcoinaddresscomp">
                                    <script type="text/javascript">
                                        document.write(window.currencyName);
                                    </script> Address Compressed Format</span>
                                <div id="detailqrcodepubliccomp" class="qrcode_public"></div>
                                <span class="output" id="detailaddresscomp"></span>
                            </div>
                        </div>
                        <br />
                        <br />
                        <div class="item clear">
                            <span class="label" id="detaillabelpublickey">Public Key (130 characters [0-9A-F]):</span>
                            <span class="output pubkeyhex" id="detailpubkey"></span>
                        </div>
                        <div class="item">
                            <span class="label" id="detaillabelpublickeycomp">Public Key (compressed, 66 characters [0-9A-F]):</span>
                            <span class="output" id="detailpubkeycomp"></span>
                        </div>
                        <hr />
                        <div class="privqr">
                            <div class="item">
                                <span class="label"><span id="detaillabelprivwif"><strong style="font-size: 150%;">Private Key WIF</strong><br />51 characters base58, starts with a</span> '
                                <script type="text/javascript">
                                    document.write(window.window.WIFPrefix);
                                </script>'</span>
                                <div id="detailqrcodeprivate" class="qrcode_private"></div>
                                <span class="output" id="detailprivwif"></span>
                            </div>
                            <div class="item right" style="display:none;" id="compressed2">
                                <span class="label"><span id="detaillabelprivwifcomp">Private Key WIF Compressed<br />52 characters base58, starts with a</span> '
                                <script type="text/javascript">
                                    document.write(window.compressedWIFPrefix);
                                </script>'</span>
                                <div id="detailqrcodeprivatecomp" class="qrcode_private"></div>
                                <span class="output" id="detailprivwifcomp"></span>
                            </div>
                        </div>
                        <br />
                        <br />
                        <div class="item clear">
                            <span class="label" id="detaillabelprivhex">Private Key Hexadecimal Format (64 characters [0-9A-F]):</span>
                            <span class="output" id="detailprivhex"></span>
                        </div>
                        <div class="item">
                            <span class="label" id="detaillabelprivb64">Private Key Base64 (44 characters):</span>
                            <span class="output" id="detailprivb64"></span>
                        </div>
                        <div class="item" style="display: none;" id="detailmini">
                            <span class="label" id="detaillabelprivmini">Private Key Mini Format (22, 26 or 30 characters, starts with an 'S'):</span>
                            <span class="output" id="detailprivmini"></span>
                        </div>
                        <div class="item" style="display: none;" id="detailb6">
                            <span class="label" id="detaillabelprivb6">Private Key Base6 Format (99 characters [0-5]):</span>
                            <span class="output" id="detailprivb6"></span>
                        </div>
                        <div class="item" style="display: none;" id="detailbip38">
                            <span class="label" id="detaillabelprivbip38">Private Key BIP38 Format (58 characters base58, starts with '6P'):</span>
                            <span class="output" id="detailprivbip38"></span>
                        </div>
                    </div>

                </div>
                <!-- end instructionsarea -->
            </div>
            <!-- end detailarea -->

        </div>
        <!-- *** end wallets *** -->

        <div id="footer" class="footer">
            <div class="authorbtc">
                <div>
                    <span class="item" id="footerlabeldonations"><b>Donations keep this service open &amp; free!</b></span>
                    <span class="item" style="font-size: 11px; font-family: 'Courier New', Courier, monospace;">
                        <strong>Bitcoin</strong>:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1Pjg628vjMLBvADrPHsthtzKiryM2y46DG<br />
                        <strong>Litecoin</strong>:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LYrGQmrvba7qJZUD7Jt4S1iejE5ndhw3CE<br />
                        <strong>Dogecoin</strong>:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSE875u8k14M3K5d93iD1fsgcHkfjjy742<br /></span>

                    <span class="item" style="font-size: 11px;">Contributions are shared by the <a href="https://bitcoinpaperwallet.com/#thanks" target="_blank">developers</a>, including pointbiz of <strong>bitaddress.org</strong>.</span>

                </div>
            </div>
            <div class="authorpgp">

                <div id="siginfo" style="display: none; position: absolute; top: -300px;">

                    After downloading and extracting the <a href="https://github.com/cantonbecker/bitcoinpaperwallet" target="_blank">ZIP package</a> for this generator, you should find a file named <b>generate-wallet.html.sig</b> which you can use to:
                    <ol>
                        <li> verify that <strong>generate-wallet.html</strong> hasn't been tampered with, and</li>
                        <li>get proof that it really was authored by Canton Becker (canton@gmail.com) whose public key and fingerprint can be confirmed at <a href="https://cantonbecker.com/webdesign/contact">cantonbecker.com</a>, bitcointalk.org, etc.</li>
                    </ol>
                    For example, if you have GPG installed, just open the terminal, change directory (cd) to where this file lives, and type:
                    <br />
                    <code> gpg --recv-key 36E1D9B6<br /> gpg --verify --with-fingerprint generate-wallet.html.sig generate-wallet.html</code>
                    <br />
                    <br />And then verify the signature's fingerprint against Canton Becker's <a href="https://cantonbecker.com/webdesign/contact" target="_blank">published PGP/GPG fingerprint</a>.
                    <br />
                    <br />
                    <a href="https://www.google.com/search?q=how+to+verify+PGP+%22.sig%22+signature+on+file">Learn how to verify a PGP-signed file &raquo;</a>
                    <br />
                    <br />
                    <a href="#" class="nicerButton" onClick="document.getElementById('siginfo').style.display='none'; return(false);">OK</a>

                </div>

                <span class="item"><b>Security &amp; signatures</b></span>
                <span class="item" style="font-size: 90%;">For <a href="https://bitcoinpaperwallet.com/#security" target="_blank">secure wallet generation</a>, do not print wallets "live" from bitcoinpaperwallet.com.<br />Instead, download this generator from GitHub and run the HTML as a "local" file:</span>
                <span class="item"><a href="https://github.com/cantonbecker/bitcoinpaperwallet" target="_blank" id="footerlabelgithub"><strong>Secure Download</strong> (GitHub ZIP file)</a></span>

                <span class="item" id="footerlabelsig" style="font-size: 90%;"><a href="#" onClick="document.getElementById('siginfo').style.display='block'; return(false);">Validate PGP/GPG signature</a></span>

                <span class="item" id="footerlabeltests" style="font-size: 90%;">Run unit tests: <a href="?unittests=1#tests">basic</a> | <a href="?asyncunittests=1#tests">async</a></span>

            </div>
            <div class="copyright">
                <span id="footerlabelcopyright1">&copy; The folding wallet design and tamper-evident seals are Copyright 2016 by Canton Becker.</span>
                <span id="footerlabelcopyright2">This software may be modified and redistributed as per the MIT/GPL/BSD/Apache licenses described in the HTML source code. However, the folding paper wallet design itself may not be modified or redistributed for commercial purposes without permission.</span>
                <br />
                <span id="footerlabelnowarranty"><strong>This software and service is provided with no warranty. Use at your own risk.</strong></span>

            </div>
        </div>
    </div>

    <script type="text/javascript" src="js/ninja.js"></script>

    <script type="text/javascript" src="js/ninja.seeder.js"></script>

    <script type="text/javascript" src="js/ninja.translator.js"></script>

    <!-- UX controls for switching tabs -->

    <script type="text/javascript">
        ninja.wallets.landwallet = {
            open: function() {
                document.getElementById("landarea").style.display = "block";
            },

            close: function() {
                document.getElementById("landarea").style.display = "none";
            }
        };
    </script>

    <script type="text/javascript">
        ninja.wallets.calibratewallet = {
            open: function() {
                document.getElementById("calibratearea").style.display = "block";
            },

            close: function() {
                document.getElementById("calibratearea").style.display = "none";
            }
        };
    </script>

    <script type="text/javascript">
        ninja.wallets.backwallet = {
            open: function() {
                document.getElementById("backarea").style.display = "block";
            },

            close: function() {
                document.getElementById("backarea").style.display = "none";
            }
        };
    </script>

    <script type="text/javascript">
        ninja.wallets.foldwallet = {
            open: function() {
                document.getElementById("foldarea").style.display = "block";
            },

            close: function() {
                document.getElementById("foldarea").style.display = "none";
            }
        };
    </script>

    <script type="text/javascript">
        ninja.wallets.paperwallet = {
            open: function() {
                document.getElementById("main").setAttribute("class", "paper"); // add 'paper' class to main div
                var paperArea = document.getElementById("paperarea");
                paperArea.style.display = "block";
                var perPageLimitElement = document.getElementById("paperlimitperpage");
                var limitElement = document.getElementById("paperlimit");
                var pageBreakAt = (ninja.wallets.paperwallet.useArtisticWallet) ? ninja.wallets.paperwallet.pageBreakAtArtisticDefault : ninja.wallets.paperwallet.pageBreakAtDefault;
                if (perPageLimitElement && perPageLimitElement.value < 1) {
                    perPageLimitElement.value = pageBreakAt;
                }
                if (limitElement && limitElement.value < 1) {
                    limitElement.value = pageBreakAt;
                }
                if (document.getElementById("paperkeyarea").innerHTML == "") {
                    document.getElementById("paperencrypt").checked = false;
                    ninja.wallets.paperwallet.encrypt = false;
                    ninja.wallets.paperwallet.build(pageBreakAt, pageBreakAt, !document.getElementById('paperart').checked, document.getElementById('paperpassphrase').value);
                }
            },

            close: function() {
                document.getElementById("paperarea").style.display = "none";
                document.getElementById("main").setAttribute("class", ""); // remove 'paper' class from main div
            },

            toggleVanityField: function(show) {
                document.getElementById('keyButtons').style.display = show ? 'none' : 'block';
                document.getElementById('supplyKeys').style.display = show ? 'block' : 'none';
            },

            remaining: null, // use to keep track of how many addresses are left to process when building the paper wallet
            count: 0,
            pageBreakAtDefault: 7,
            pageBreakAtArtisticDefault: 1,
            useArtisticWallet: true,
            pageBreakAt: null,
            passphrase: null,
            lastwallet: null,
            minPassphraseLength: 15,

            build: function(numWallets, pageBreakAt, useArtisticWallet, passphrase) {
                if (numWallets < 1) numWallets = 1;
                ninja.wallets.paperwallet.remaining = numWallets;
                ninja.wallets.paperwallet.count = 0;
                ninja.wallets.paperwallet.useArtisticWallet = useArtisticWallet;
                ninja.wallets.paperwallet.pageBreakAt = pageBreakAt;
                document.getElementById("paperkeyarea").innerHTML = "";
                if (ninja.wallets.paperwallet.encrypt && passphrase == "") {
                    alert(ninja.translator.get("bip38alertpassphraserequired"));
                    return;
                }
                ninja.wallets.paperwallet.passphrase = passphrase;
                setTimeout(ninja.wallets.paperwallet.batch, 0);
            },

            buildManual: function(wallet, passphrase) {
                ninja.wallets.paperwallet.remaining = 1;
                ninja.wallets.paperwallet.count = 0;
                ninja.wallets.paperwallet.pageBreakAt = 1;
                document.getElementById("paperkeyarea").innerHTML = "";
                if (ninja.wallets.paperwallet.encrypt && passphrase == "") {
                    alert(ninja.translator.get("bip38alertpassphraserequired"));
                    return;
                }
                ninja.wallets.paperwallet.passphrase = passphrase;
                setTimeout(function() {
                    ninja.wallets.paperwallet.batch(wallet);
                }, 0);
            },

            batch: function(addressSeed) {
                if (ninja.wallets.paperwallet.remaining > 0) {
                    var paperArea = document.getElementById("paperkeyarea");
                    ninja.wallets.paperwallet.count++;
                    var i = ninja.wallets.paperwallet.count;
                    var pageBreakAt = ninja.wallets.paperwallet.pageBreakAt;
                    var div = document.createElement("div");
                    div.setAttribute("id", "keyarea" + i);
                    div.innerHTML = ninja.wallets.paperwallet.templateArtisticHtml(i);
                    div.setAttribute("class", "keyarea art");
                    if (paperArea.innerHTML != "") {
                        // page break
                        if ((i - 1) % pageBreakAt == 0 && i >= pageBreakAt) {
                            var pBreak = document.createElement("div");
                            pBreak.setAttribute("class", "pagebreak");
                            document.getElementById("paperkeyarea").appendChild(pBreak);
                            div.style.pageBreakBefore = "always";
                            if (!ninja.wallets.paperwallet.useArtisticWallet) {
                                div.style.borderTop = "2px solid green";
                            }
                        }
                    }
                    document.getElementById("paperkeyarea").appendChild(div);
                    ninja.wallets.paperwallet.generateNewWallet(addressSeed, function(wallet) {
                        var walletKey = ninja.wallets.paperwallet.encrypt ? wallet.encryptedKey : wallet.wifKey;
                        ninja.wallets.paperwallet.showArtisticWallet(i, wallet.address, walletKey);
                    });
                    ninja.wallets.paperwallet.remaining--;
                    setTimeout(ninja.wallets.paperwallet.batch, 0);
                }
            },

            generateNewWallet: function(addressSeed, callback) {
                if (addressSeed == null) {
                    var key = new Bitcoin.ECKey(false);
                    addressSeed = {
                        address: key.getBitcoinAddress(),
                        wifKey: key.getBitcoinWalletImportFormat()
                    };
                }
                ninja.wallets.paperwallet.lastwallet = addressSeed;
                if (ninja.wallets.paperwallet.encrypt) {
                    document.getElementById("busyblock").className = "busy";
                    setTimeout(function() {
                        ninja.privateKey.BIP38PrivateKeyToEncryptedKeyAsync(addressSeed.wifKey, ninja.wallets.paperwallet.passphrase, false, function(encodedKey) {
                            document.getElementById("busyblock").className = "";
                            addressSeed.passphrase = ninja.wallets.paperwallet.passphrase;
                            addressSeed.encryptedKey = encodedKey;
                            ninja.wallets.paperwallet.lastwallet.addressSeed = addressSeed;
                            callback(addressSeed);
                        });
                    }, 10);
                } else {
                    callback(addressSeed);
                }
            },

            templateArtisticHtml: function(i) {
                var keyelement = 'btcprivwif';
                if (ninja.wallets.paperwallet.encrypt) {
                    keyelement = 'btcencryptedkey'
                }

                var walletHtml =
                    "<div class='artwallet' id='artwallet" + i + "'>" +
                    //"<iframe src='bitcoin-wallet-01.svg' id='papersvg" + i + "' class='papersvg' ></iframe>" +
                    // "<img id='papersvg" + i + "' class='papersvg' src='" + window.frontJPG + "' />" +
                    "<img id='papersvg" + i + "' class='papersvg' src='" + "" + "' />" +
                    "<div id='qrcode_public" + i + "' class='qrcode_public'></div>" +
                    "<div id='qrcode_private" + i + "' class='qrcode_private'></div>" +
                    "<div class='btcaddress' id='btcaddress" + i + "'></div>" +
                    "<div class='dupbtcaddress' id='dupbtcaddress" + i + "'></div>" +
                    "<div class='" + keyelement + "' id='" + keyelement + i + "'></div>" +
                    "<div class='dup" + keyelement + "' id='dup" + keyelement + i + "'></div>" +
                    "<div class='wallettype' id='wallettype" + i + "'></div>" +
                    "</div>";
                return walletHtml;
            },

            showArtisticWallet: function(idPostFix, bitcoinAddress, privateKey) {

                // BIP38 coloration
                var colors = {
                    'bip38': {
                        publicUpper: "#fff57c",
                        publicLower: "#f7931a",
                        privateLeft: "#78bad6",
                        privateRight: "#fff67d",
                        pointer: "#0084a8",
                        guilloche: "white",
                        text: "#1937a9",
                        textShadow: "white",
                        textPointer: "white",
                    },
                    'default': {
                        publicUpper: "#fff57c",
                        publicLower: "#f7931a",
                        privateLeft: "#8cd96f",
                        privateRight: "#fff67d",
                        pointer: "#02ab5c",
                        guilloche: "white",
                        text: "#1937a9",
                        textShadow: "white",
                        textPointer: "white",
                    }
                };

                var keyValuePair = {};
                keyValuePair["qrcode_public" + idPostFix] = bitcoinAddress;
                keyValuePair["qrcode_private" + idPostFix] = privateKey;
                ninja.qrCode.showQrCode(keyValuePair, 2.75);
                document.getElementById("btcaddress" + idPostFix).innerHTML = bitcoinAddress;
                document.getElementById("dupbtcaddress" + idPostFix).innerHTML = bitcoinAddress;

                if (ninja.wallets.paperwallet.encrypt) {
                    var half = privateKey.length / 2;
                    document.getElementById("btcencryptedkey" + idPostFix).innerHTML = privateKey;
                    document.getElementById("dupbtcencryptedkey" + idPostFix).innerHTML = privateKey;
                    if (window.designChoice != 'default') document.getElementById("wallettype" + idPostFix).innerHTML = 'BIP38 ENCRYPTED'; // only add for special designs
                    drawOpts.text['walletImportFormat'] = 'BIP38 ENCRYPTED';
                    drawOpts.color = colors['bip38'];
                } else {
                    document.getElementById("btcprivwif" + idPostFix).innerHTML = privateKey;
                    document.getElementById("dupbtcprivwif" + idPostFix).innerHTML = privateKey;
                    document.getElementById("wallettype" + idPostFix).innerHTML = '';
                    drawOpts.color = colors['default'];
                    if (window.designChoice != 'default') document.getElementById("wallettype" + idPostFix).innerHTML = ''; // special designs should have this burned into the JPG
                    drawOpts.text['walletImportFormat'] = 'WALLET IMPORT FORMAT';
                }

                if (window.designChoice == 'default') { // if we are not loading up a special JPG-based design, render the canvas
                    document.getElementById("papersvg1").src = PaperWallet.draw.frontImage(bitcoinAddress, drawOpts);
                }
                // CODE to modify SVG DOM elements
                //var paperSvg = document.getElementById("papersvg" + idPostFix);
                //if (paperSvg) {
                //	svgDoc = paperSvg.contentDocument;
                //	if (svgDoc) {
                //		var bitcoinAddressElement = svgDoc.getElementById("bitcoinaddress");
                //		var privateKeyElement = svgDoc.getElementById("privatekey");
                //		if (bitcoinAddressElement && privateKeyElement) {
                //			bitcoinAddressElement.textContent = bitcoinAddress;
                //			privateKeyElement.textContent = privateKeyWif;
                //		}
                //	}
                //}
            },

            toggleArt: function(element) {
                if (!element.checked) {
                    // show Art
                    document.getElementById("paperlimitperpage").value = ninja.wallets.paperwallet.pageBreakAtArtisticDefault;
                    document.getElementById("paperlimit").value = ninja.wallets.paperwallet.pageBreakAtArtisticDefault;
                } else {
                    // hide Art
                    document.getElementById("paperlimitperpage").value = ninja.wallets.paperwallet.pageBreakAtDefault;
                    document.getElementById("paperlimit").value = ninja.wallets.paperwallet.pageBreakAtDefault;
                }
            },

            toggleEncryptSettings: function(show, cancelSave) {
                if (show == null)
                    show = document.getElementById('paperbip38settings').className != 'show';
                var encryptBox = document.getElementById('paperencrypt');
                if (cancelSave == true) {
                    encryptBox.checked = ninja.wallets.paperwallet.encrypt;
                }

                document.getElementById('paperbip38settings').className = show ? 'show' : '';
                if (!cancelSave) document.getElementById('paperencryptpassphrase').innerText =
                    document.getElementById('paperencryptpassphrase').textContent = document.getElementById('paperpassphrase').value;

                if (!show && !cancelSave) {
                    ninja.wallets.paperwallet.encrypt = encryptBox.checked;
                    ninja.wallets.paperwallet.buildManual(ninja.wallets.paperwallet.lastwallet, document.getElementById('paperpassphrase').value);
                    ninja.wallets.paperwallet.resetLimits();
                }

                document.getElementById('paperencryptstatus').className = ninja.wallets.paperwallet.encrypt ? '' : 'hide';
            },

            resetLimits: function() {
                var hideArt = document.getElementById("paperart");
                var paperEncrypt = document.getElementById("paperencrypt");
                var limit;
                var limitperpage;

                document.getElementById("paperkeyarea").style.fontSize = "100%";
                if (!hideArt.checked) {
                    limit = ninja.wallets.paperwallet.pageBreakAtArtisticDefault;
                    limitperpage = ninja.wallets.paperwallet.pageBreakAtArtisticDefault;
                } else if (hideArt.checked && paperEncrypt.checked) {
                    limit = ninja.wallets.paperwallet.pageBreakAtDefault;
                    limitperpage = ninja.wallets.paperwallet.pageBreakAtDefault;
                    // reduce font size
                    document.getElementById("paperkeyarea").style.fontSize = "95%";
                } else if (hideArt.checked && !paperEncrypt.checked) {
                    limit = ninja.wallets.paperwallet.pageBreakAtDefault;
                    limitperpage = ninja.wallets.paperwallet.pageBreakAtDefault;
                }
                document.getElementById("paperlimitperpage").value = limitperpage;
                document.getElementById("paperlimit").value = limit;
            }
        };
    </script>

    <script type="text/javascript">
        ninja.wallets.detailwallet = {
            qrscanner: {
                scanner: null,

                start: function() {
                    document.getElementById('paperqrscanner').className = 'show';
                    ninja.wallets.detailwallet.qrscanner.showError(null);
                    var supported = ninja.wallets.detailwallet.qrscanner.scanner.isSupported();
                    if (!supported) {
                        document.getElementById('paperqrnotsupported').className = '';
                    } else {
                        ninja.wallets.detailwallet.qrscanner.scanner.start();
                    }
                },

                stop: function() {
                    ninja.wallets.detailwallet.qrscanner.scanner.stop();
                    document.getElementById('paperqrscanner').className = '';
                },

                showError: function(error) {
                    if (error) {
                        if (error == 'PERMISSION_DENIED' || error == 'PermissionDeniedError') {
                            document.getElementById('paperqrerror').innerHTML = '';
                            document.getElementById('paperqrpermissiondenied').className = '';
                        } else {
                            document.getElementById('paperqrerror').innerHTML = error;
                            document.getElementById('paperqrpermissiondenied').className = 'hide';
                        }
                    } else {
                        document.getElementById('paperqrerror').innerHTML = '';
                        document.getElementById('paperqrpermissiondenied').className = 'hide';
                    }
                }
            },

            open: function() {
                document.getElementById("detailarea").style.display = "block";
                document.getElementById("detailprivkey").focus();
                if (!ninja.wallets.detailwallet.qrscanner.scanner) {
                    ninja.wallets.detailwallet.qrscanner.scanner = new QRCodeScanner(320, 240, 'paperqroutput',
                        function(data) {
                            document.getElementById('detailprivkey').value = data;
                            document.getElementById('paperqrscanner').className = '';
                        },
                        function(error) {
                            ninja.wallets.detailwallet.qrscanner.showError(error);
                        });
                }
            },

            close: function() {
                document.getElementById("detailarea").style.display = "none";
            },

            openCloseFaq: function(faqNum) {
                // do close
                if (document.getElementById("detaila" + faqNum).style.display == "block") {
                    document.getElementById("detaila" + faqNum).style.display = "none";
                    document.getElementById("detaile" + faqNum).setAttribute("class", "more");
                }
                // do open
                else {
                    document.getElementById("detaila" + faqNum).style.display = "block";
                    document.getElementById("detaile" + faqNum).setAttribute("class", "less");
                }
            },

            viewDetails: function() {
                var bip38 = false;
                var key = document.getElementById("detailprivkey").value.toString().replace(/^\s+|\s+$/g, ""); // trim white space
                document.getElementById("detailprivkey").value = key;
                var bip38CommandDisplay = document.getElementById("detailbip38commands").style.display;
                ninja.wallets.detailwallet.clear();
                if (key == "") {
                    return;
                }
                if (ninja.privateKey.isBIP38Format(key)) {
                    document.getElementById("detailbip38commands").style.display = bip38CommandDisplay;
                    if (bip38CommandDisplay != "block") {
                        document.getElementById("detailbip38commands").style.display = "block";
                        document.getElementById("detailprivkeypassphrase").focus();
                        return;
                    }
                    var passphrase = document.getElementById("detailprivkeypassphrase").value.toString().replace(/^\s+|\s+$/g, ""); // trim white space
                    if (passphrase == "") {
                        alert(ninja.translator.get("bip38alertpassphraserequired"));
                        return;
                    }
                    document.getElementById("busyblock_decrypt").className = "busy";
                    // show Private Key BIP38 Format
                    document.getElementById("detailprivbip38").innerHTML = key;
                    document.getElementById("detailbip38").style.display = "block";
                    ninja.privateKey.BIP38EncryptedKeyToByteArrayAsync(key, passphrase, function(btcKeyOrError) {
                        document.getElementById("busyblock_decrypt").className = "";
                        if (btcKeyOrError.message) {
                            alert(btcKeyOrError.message);
                            ninja.wallets.detailwallet.clear();
                        } else {
                            ninja.wallets.detailwallet.populateKeyDetails(new Bitcoin.ECKey(btcKeyOrError));
                        }
                    });
                } else {
                    if (Bitcoin.ECKey.isMiniFormat(key)) {
                        // show Private Key Mini Format
                        document.getElementById("detailprivmini").innerHTML = key;
                        document.getElementById("detailmini").style.display = "block";
                    } else if (Bitcoin.ECKey.isBase6Format(key)) {
                        // show Private Key Base6 Format
                        document.getElementById("detailprivb6").innerHTML = key;
                        document.getElementById("detailb6").style.display = "block";
                    }
                    var btcKey = new Bitcoin.ECKey(key);
                    if (btcKey.priv == null) {
                        // enforce a minimum passphrase length
                        if (key.length >= ninja.wallets.paperwallet.minPassphraseLength) {
                            // Deterministic Wallet confirm box to ask if user wants to SHA256 the input to get a private key
                            var usePassphrase = confirm(ninja.translator.get("detailconfirmsha256"));
                            if (usePassphrase) {
                                var bytes = Crypto.SHA256(key, {
                                    asBytes: true
                                });
                                var btcKey = new Bitcoin.ECKey(bytes);
                            } else {
                                ninja.wallets.detailwallet.clear();
                            }
                        } else {
                            alert(ninja.translator.get("detailalertnotvalidprivatekey"));
                            ninja.wallets.detailwallet.clear();
                        }
                    }
                    ninja.wallets.detailwallet.populateKeyDetails(btcKey);
                }
            },

            populateKeyDetails: function(btcKey) {
                if (btcKey.priv != null) {
                    btcKey.setCompressed(false);
                    document.getElementById('detailkeyarea').className = '';
                    document.getElementById('detailkeyareakey').innerHTML = document.getElementById('detailprivkey').value;
                    document.getElementById("detailprivhex").innerHTML = btcKey.toString().toUpperCase();
                    document.getElementById("detailprivb64").innerHTML = btcKey.toString("base64");
                    var bitcoinAddress = btcKey.getBitcoinAddress();
                    var wif = btcKey.getBitcoinWalletImportFormat();
                    ninja.wallets.detailwallet.lastwallet = {
                        address: bitcoinAddress,
                        wifKey: wif
                    };
                    document.getElementById("detailpubkey").innerHTML = btcKey.getPubKeyHex();
                    document.getElementById("detailaddress").innerHTML = bitcoinAddress;
                    document.getElementById("detailprivwif").innerHTML = wif;
                    btcKey.setCompressed(true);
                    var bitcoinAddressComp = btcKey.getBitcoinAddress();
                    var wifComp = btcKey.getBitcoinWalletImportFormat();
                    document.getElementById("detailpubkeycomp").innerHTML = btcKey.getPubKeyHex();
                    document.getElementById("detailaddresscomp").innerHTML = bitcoinAddressComp;
                    document.getElementById("detailprivwifcomp").innerHTML = wifComp;

                    ninja.qrCode.showQrCode({
                        "detailqrcodepublic": bitcoinAddress,
                        "detailqrcodepubliccomp": bitcoinAddressComp,
                        "detailqrcodeprivate": wif,
                        "detailqrcodeprivatecomp": wifComp
                    }, 4);
                }
            },

            clear: function() {
                document.getElementById('detailkeyarea').className = 'hide';
                document.getElementById("detailpubkey").innerHTML = "";
                document.getElementById("detailpubkeycomp").innerHTML = "";
                document.getElementById("detailaddress").innerHTML = "";
                document.getElementById("detailaddresscomp").innerHTML = "";
                document.getElementById("detailprivwif").innerHTML = "";
                document.getElementById("detailprivwifcomp").innerHTML = "";
                document.getElementById("detailprivhex").innerHTML = "";
                document.getElementById("detailprivb64").innerHTML = "";
                document.getElementById("detailprivb6").innerHTML = "";
                document.getElementById("detailprivmini").innerHTML = "";
                document.getElementById("detailprivbip38").innerHTML = "";
                document.getElementById("detailqrcodepublic").innerHTML = "";
                document.getElementById("detailqrcodepubliccomp").innerHTML = "";
                document.getElementById("detailqrcodeprivate").innerHTML = "";
                document.getElementById("detailqrcodeprivatecomp").innerHTML = "";
                document.getElementById("detailb6").style.display = "none";
                document.getElementById("detailmini").style.display = "none";
                document.getElementById("detailbip38commands").style.display = "none";
                document.getElementById("detailbip38").style.display = "none";
            },

            loadInPaperWallet: function() {
                document.getElementById("paperkeyarea").innerHTML = 'Loading...';
                ninja.tabSwitch(document.getElementById('paperwallet'));
                ninja.wallets.paperwallet.toggleVanityField(true);
                document.getElementById('suppliedPrivateKey').value = ninja.wallets.detailwallet.lastwallet.wifKey;
                if (ninja.wallets.paperwallet.encrypt && !confirm('Do you want to encrypt this wallet using the previously supplied private key?')) {
                    document.getElementById('paperencrypt').checked = false;
                    ninja.wallets.paperwallet.toggleEncryptSettings(false);
                }
                ninja.wallets.paperwallet.buildManual(ninja.wallets.detailwallet.lastwallet, ninja.wallets.paperwallet.passphrase);
            }
        };
    </script>

    <script type="text/javascript">
        (function(ninja) {
            var ut = ninja.unitTests = {
                runSynchronousTests: function() {
                    document.getElementById("busyblock").className = "busy";
                    var div = document.createElement("div");
                    div.setAttribute("class", "unittests");
                    div.setAttribute("id", "unittests");
                    var testResults = "";
                    var passCount = 0;
                    var testCount = 0;
                    for (var test in ut.synchronousTests) {
                        var exceptionMsg = "";
                        var resultBool = false;
                        try {
                            resultBool = ut.synchronousTests[test]();
                        } catch (ex) {
                            exceptionMsg = ex.toString();
                            resultBool = false;
                        }
                        if (resultBool == true) {
                            var passFailStr = "pass";
                            passCount++;
                        } else {
                            var passFailStr = "<b>FAIL " + exceptionMsg + "</b>";
                        }
                        testCount++;
                        testResults += test + ": " + passFailStr + "<br/>";
                    }
                    testResults += passCount + " of " + testCount + " synchronous tests passed";
                    if (passCount < testCount) {
                        testResults += "<b>" + (testCount - passCount) + " unit test(s) failed</b>";
                    }
                    div.innerHTML = "<a name=\"tests\"></a><h3>Unit Tests</h3><div id=\"unittestresults\">" + testResults + "<br/><br/></div>";
                    document.body.appendChild(div);
                    document.getElementById("busyblock").className = "";

                },

                runAsynchronousTests: function() {
                    var div = document.createElement("div");
                    div.setAttribute("class", "unittests");
                    div.setAttribute("id", "asyncunittests");
                    div.innerHTML = "<a name=\"tests\"></a><h3>Async Unit Tests</h3><div id=\"asyncunittestresults\"></div><br/><br/><br/><br/>";
                    document.body.appendChild(div);

                    // run the asynchronous tests one after another so we don't crash the browser
                    ninja.foreachSerialized(ninja.unitTests.asynchronousTests, function(name, cb) {
                        document.getElementById("busyblock").className = "busy";
                        ninja.unitTests.asynchronousTests[name](cb);
                    }, function() {
                        document.getElementById("asyncunittestresults").innerHTML += "running of asynchronous unit tests complete!<br/>";
                        document.getElementById("busyblock").className = "";
                    });
                },

                synchronousTests: {
                    //ninja.publicKey tests
                    testIsPublicKeyHexFormat: function() {
                        var key = "0478982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB521F054FAD982AF4CC1933AFD1F1B563EA779A6AA6CCE36A30B947DD653E63E44";
                        var bool = ninja.publicKey.isPublicKeyHexFormat(key);
                        if (bool != true) {
                            return false;
                        }
                        return true;
                    },
                    testGetHexFromByteArray: function() {
                        var bytes = [4, 120, 152, 47, 64, 250, 12, 11, 122, 85, 113, 117, 131, 175, 201, 154, 78, 223, 211, 1, 162, 114, 157, 197, 155, 11, 142, 185, 225, 134, 146, 188, 181, 33, 240, 84, 250, 217, 130, 175, 76, 193, 147, 58, 253, 31, 27, 86, 62, 167, 121, 166, 170, 108, 206, 54, 163, 11, 148, 125, 214, 83, 230, 62, 68];
                        var key = ninja.publicKey.getHexFromByteArray(bytes);
                        if (key != "0478982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB521F054FAD982AF4CC1933AFD1F1B563EA779A6AA6CCE36A30B947DD653E63E44") {
                            return false;
                        }
                        return true;
                    },
                    testHexToBytes: function() {
                        var key = "0478982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB521F054FAD982AF4CC1933AFD1F1B563EA779A6AA6CCE36A30B947DD653E63E44";
                        var bytes = Crypto.util.hexToBytes(key);
                        if (bytes.toString() != "4,120,152,47,64,250,12,11,122,85,113,117,131,175,201,154,78,223,211,1,162,114,157,197,155,11,142,185,225,134,146,188,181,33,240,84,250,217,130,175,76,193,147,58,253,31,27,86,62,167,121,166,170,108,206,54,163,11,148,125,214,83,230,62,68") {
                            return false;
                        }
                        return true;
                    },
                    testGetBitcoinAddressFromByteArray: function() {
                        var bytes = [4, 120, 152, 47, 64, 250, 12, 11, 122, 85, 113, 117, 131, 175, 201, 154, 78, 223, 211, 1, 162, 114, 157, 197, 155, 11, 142, 185, 225, 134, 146, 188, 181, 33, 240, 84, 250, 217, 130, 175, 76, 193, 147, 58, 253, 31, 27, 86, 62, 167, 121, 166, 170, 108, 206, 54, 163, 11, 148, 125, 214, 83, 230, 62, 68];
                        var address = ninja.publicKey.getBitcoinAddressFromByteArray(bytes);
                        if (address != "1Cnz9ULjzBPYhDw1J8bpczDWCEXnC9HuU1") {
                            return false;
                        }
                        return true;
                    },
                    testGetByteArrayFromAdding: function() {
                        var key1 = "0478982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB521F054FAD982AF4CC1933AFD1F1B563EA779A6AA6CCE36A30B947DD653E63E44";
                        var key2 = "0419153E53FECAD7FF07FEC26F7DDEB1EDD66957711AA4554B8475F10AFBBCD81C0159DC0099AD54F733812892EB9A11A8C816A201B3BAF0D97117EBA2033C9AB2";
                        var bytes = ninja.publicKey.getByteArrayFromAdding(key1, key2);
                        if (bytes.toString() != "4,151,19,227,152,54,37,184,255,4,83,115,216,102,189,76,82,170,57,4,196,253,2,41,74,6,226,33,167,199,250,74,235,223,128,233,99,150,147,92,57,39,208,84,196,71,68,248,166,106,138,95,172,253,224,70,187,65,62,92,81,38,253,79,0") {
                            return false;
                        }
                        return true;
                    },
                    testGetByteArrayFromAddingCompressed: function() {
                        var key1 = "0278982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB5";
                        var key2 = "0219153E53FECAD7FF07FEC26F7DDEB1EDD66957711AA4554B8475F10AFBBCD81C";
                        var bytes = ninja.publicKey.getByteArrayFromAdding(key1, key2);
                        var hex = ninja.publicKey.getHexFromByteArray(bytes);
                        if (hex != "029713E3983625B8FF045373D866BD4C52AA3904C4FD02294A06E221A7C7FA4AEB") {
                            return false;
                        }
                        return true;
                    },
                    testGetByteArrayFromAddingUncompressedAndCompressed: function() {
                        var key1 = "0478982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB521F054FAD982AF4CC1933AFD1F1B563EA779A6AA6CCE36A30B947DD653E63E44";
                        var key2 = "0219153E53FECAD7FF07FEC26F7DDEB1EDD66957711AA4554B8475F10AFBBCD81C";
                        var bytes = ninja.publicKey.getByteArrayFromAdding(key1, key2);
                        if (bytes.toString() != "4,151,19,227,152,54,37,184,255,4,83,115,216,102,189,76,82,170,57,4,196,253,2,41,74,6,226,33,167,199,250,74,235,223,128,233,99,150,147,92,57,39,208,84,196,71,68,248,166,106,138,95,172,253,224,70,187,65,62,92,81,38,253,79,0") {
                            return false;
                        }
                        return true;
                    },
                    testGetByteArrayFromAddingShouldReturnNullWhenSameKey1: function() {
                        var key1 = "0478982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB521F054FAD982AF4CC1933AFD1F1B563EA779A6AA6CCE36A30B947DD653E63E44";
                        var key2 = "0478982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB521F054FAD982AF4CC1933AFD1F1B563EA779A6AA6CCE36A30B947DD653E63E44";
                        var bytes = ninja.publicKey.getByteArrayFromAdding(key1, key2);
                        if (bytes != null) {
                            return false;
                        }
                        return true;
                    },
                    testGetByteArrayFromAddingShouldReturnNullWhenSameKey2: function() {
                        var key1 = "0478982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB521F054FAD982AF4CC1933AFD1F1B563EA779A6AA6CCE36A30B947DD653E63E44";
                        var key2 = "0278982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB5";
                        var bytes = ninja.publicKey.getByteArrayFromAdding(key1, key2);
                        if (bytes != null) {
                            return false;
                        }
                        return true;
                    },
                    testGetByteArrayFromMultiplying: function() {
                        var key1 = "0478982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB521F054FAD982AF4CC1933AFD1F1B563EA779A6AA6CCE36A30B947DD653E63E44";
                        var key2 = "SQE6yipP5oW8RBaStWoB47xsRQ8pat";
                        var bytes = ninja.publicKey.getByteArrayFromMultiplying(key1, new Bitcoin.ECKey(key2));
                        if (bytes.toString() != "4,102,230,163,180,107,9,21,17,48,35,245,227,110,199,119,144,57,41,112,64,245,182,40,224,41,230,41,5,26,206,138,57,115,35,54,105,7,180,5,106,217,57,229,127,174,145,215,79,121,163,191,211,143,215,50,48,156,211,178,72,226,68,150,52") {
                            return false;
                        }
                        return true;
                    },
                    testGetByteArrayFromMultiplyingCompressedOutputsUncompressed: function() {
                        var key1 = "0278982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB5";
                        var key2 = "SQE6yipP5oW8RBaStWoB47xsRQ8pat";
                        var bytes = ninja.publicKey.getByteArrayFromMultiplying(key1, new Bitcoin.ECKey(key2));
                        if (bytes.toString() != "4,102,230,163,180,107,9,21,17,48,35,245,227,110,199,119,144,57,41,112,64,245,182,40,224,41,230,41,5,26,206,138,57,115,35,54,105,7,180,5,106,217,57,229,127,174,145,215,79,121,163,191,211,143,215,50,48,156,211,178,72,226,68,150,52") {
                            return false;
                        }
                        return true;
                    },
                    testGetByteArrayFromMultiplyingCompressedOutputsCompressed: function() {
                        var key1 = "0278982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB5";
                        var key2 = "L1n4cgNZAo2KwdUc15zzstvo1dcxpBw26NkrLqfDZtU9AEbPkLWu";
                        var ecKey = new Bitcoin.ECKey(key2);
                        var bytes = ninja.publicKey.getByteArrayFromMultiplying(key1, ecKey);
                        if (bytes.toString() != "2,102,230,163,180,107,9,21,17,48,35,245,227,110,199,119,144,57,41,112,64,245,182,40,224,41,230,41,5,26,206,138,57") {
                            return false;
                        }
                        return true;
                    },
                    testGetByteArrayFromMultiplyingShouldReturnNullWhenSameKey1: function() {
                        var key1 = "0478982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB521F054FAD982AF4CC1933AFD1F1B563EA779A6AA6CCE36A30B947DD653E63E44";
                        var key2 = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var bytes = ninja.publicKey.getByteArrayFromMultiplying(key1, new Bitcoin.ECKey(key2));
                        if (bytes != null) {
                            return false;
                        }
                        return true;
                    },
                    testGetByteArrayFromMultiplyingShouldReturnNullWhenSameKey2: function() {
                        var key1 = "0278982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB5";
                        var key2 = "KxbhchnQquYQ2dfSxz7rrEaQTCukF4uCV57TkamyTbLzjFWcdi3S";
                        var bytes = ninja.publicKey.getByteArrayFromMultiplying(key1, new Bitcoin.ECKey(key2));
                        if (bytes != null) {
                            return false;
                        }
                        return true;
                    },
                    // confirms multiplication is working and BigInteger was created correctly (Pub Key B vs Priv Key A)
                    testGetPubHexFromMultiplyingPrivAPubB: function() {
                        var keyPub = "04F04BF260DCCC46061B5868F60FE962C77B5379698658C98A93C3129F5F98938020F36EBBDE6F1BEAF98E5BD0E425747E68B0F2FB7A2A59EDE93F43C0D78156FF";
                        var keyPriv = "B1202A137E917536B3B4C5010C3FF5DDD4784917B3EEF21D3A3BF21B2E03310C";
                        var bytes = ninja.publicKey.getByteArrayFromMultiplying(keyPub, new Bitcoin.ECKey(keyPriv));
                        var pubHex = ninja.publicKey.getHexFromByteArray(bytes);
                        if (pubHex != "04C6732006AF4AE571C7758DF7A7FB9E3689DFCF8B53D8724D3A15517D8AB1B4DBBE0CB8BB1C4525F8A3001771FC7E801D3C5986A555E2E9441F1AD6D181356076") {
                            return false;
                        }
                        return true;
                    },
                    // confirms multiplication is working and BigInteger was created correctly (Pub Key A vs Priv Key B)
                    testGetPubHexFromMultiplyingPrivBPubA: function() {
                        var keyPub = "0429BF26C0AF7D31D608474CEBD49DA6E7C541B8FAD95404B897643476CE621CFD05E24F7AE8DE8033AADE5857DB837E0B704A31FDDFE574F6ECA879643A0D3709";
                        var keyPriv = "7DE52819F1553C2BFEDE6A2628B6FDDF03C2A07EB21CF77ACA6C2C3D252E1FD9";
                        var bytes = ninja.publicKey.getByteArrayFromMultiplying(keyPub, new Bitcoin.ECKey(keyPriv));
                        var pubHex = ninja.publicKey.getHexFromByteArray(bytes);
                        if (pubHex != "04C6732006AF4AE571C7758DF7A7FB9E3689DFCF8B53D8724D3A15517D8AB1B4DBBE0CB8BB1C4525F8A3001771FC7E801D3C5986A555E2E9441F1AD6D181356076") {
                            return false;
                        }
                        return true;
                    },

                    // Private Key tests
                    testBadKeyIsNotWif: function() {
                        return !(Bitcoin.ECKey.isWalletImportFormat("bad key"));
                    },
                    testBadKeyIsNotWifCompressed: function() {
                        return !(Bitcoin.ECKey.isCompressedWalletImportFormat("bad key"));
                    },
                    testBadKeyIsNotHex: function() {
                        return !(Bitcoin.ECKey.isHexFormat("bad key"));
                    },
                    testBadKeyIsNotBase64: function() {
                        return !(Bitcoin.ECKey.isBase64Format("bad key"));
                    },
                    testBadKeyIsNotMini: function() {
                        return !(Bitcoin.ECKey.isMiniFormat("bad key"));
                    },
                    testBadKeyReturnsNullPrivFromECKey: function() {
                        var key = "bad key";
                        var ecKey = new Bitcoin.ECKey(key);
                        if (ecKey.priv != null) {
                            return false;
                        }
                        return true;
                    },
                    testGetBitcoinPrivateKeyByteArray: function() {
                        var key = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var bytes = [41, 38, 101, 195, 135, 36, 24, 173, 241, 218, 127, 250, 58, 100, 111, 47, 6, 2, 36, 109, 166, 9, 138, 145, 210, 41, 195, 33, 80, 242, 113, 139];
                        var btcKey = new Bitcoin.ECKey(key);
                        if (btcKey.getBitcoinPrivateKeyByteArray().toString() != bytes.toString()) {
                            return false;
                        }
                        return true;
                    },
                    testECKeyDecodeWalletImportFormat: function() {
                        var key = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var bytes1 = [41, 38, 101, 195, 135, 36, 24, 173, 241, 218, 127, 250, 58, 100, 111, 47, 6, 2, 36, 109, 166, 9, 138, 145, 210, 41, 195, 33, 80, 242, 113, 139];
                        var bytes2 = Bitcoin.ECKey.decodeWalletImportFormat(key);
                        if (bytes1.toString() != bytes2.toString()) {
                            return false;
                        }
                        return true;
                    },
                    testECKeyDecodeCompressedWalletImportFormat: function() {
                        var key = "KxbhchnQquYQ2dfSxz7rrEaQTCukF4uCV57TkamyTbLzjFWcdi3S";
                        var bytes1 = [41, 38, 101, 195, 135, 36, 24, 173, 241, 218, 127, 250, 58, 100, 111, 47, 6, 2, 36, 109, 166, 9, 138, 145, 210, 41, 195, 33, 80, 242, 113, 139];
                        var bytes2 = Bitcoin.ECKey.decodeCompressedWalletImportFormat(key);
                        if (bytes1.toString() != bytes2.toString()) {
                            return false;
                        }
                        return true;
                    },
                    testWifToPubKeyHex: function() {
                        var key = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var btcKey = new Bitcoin.ECKey(key);
                        if (btcKey.getPubKeyHex() != "0478982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB521F054FAD982AF4CC1933AFD1F1B563EA779A6AA6CCE36A30B947DD653E63E44" ||
                            btcKey.getPubPoint().compressed != false) {
                            return false;
                        }
                        return true;
                    },
                    testWifToPubKeyHexCompressed: function() {
                        var key = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var btcKey = new Bitcoin.ECKey(key);
                        btcKey.setCompressed(true);
                        if (btcKey.getPubKeyHex() != "0278982F40FA0C0B7A55717583AFC99A4EDFD301A2729DC59B0B8EB9E18692BCB5" ||
                            btcKey.getPubPoint().compressed != true) {
                            return false;
                        }
                        return true;
                    },
                    testBase64ToECKey: function() {
                        var key = "KSZlw4ckGK3x2n/6OmRvLwYCJG2mCYqR0inDIVDycYs=";
                        var btcKey = new Bitcoin.ECKey(key);
                        if (btcKey.getBitcoinBase64Format() != "KSZlw4ckGK3x2n/6OmRvLwYCJG2mCYqR0inDIVDycYs=") {
                            return false;
                        }
                        return true;
                    },
                    testHexToECKey: function() {
                        var key = "292665C3872418ADF1DA7FFA3A646F2F0602246DA6098A91D229C32150F2718B";
                        var btcKey = new Bitcoin.ECKey(key);
                        if (btcKey.getBitcoinHexFormat() != "292665C3872418ADF1DA7FFA3A646F2F0602246DA6098A91D229C32150F2718B") {
                            return false;
                        }
                        return true;
                    },
                    testCompressedWifToECKey: function() {
                        var key = "KxbhchnQquYQ2dfSxz7rrEaQTCukF4uCV57TkamyTbLzjFWcdi3S";
                        var btcKey = new Bitcoin.ECKey(key);
                        if (btcKey.getBitcoinWalletImportFormat() != "KxbhchnQquYQ2dfSxz7rrEaQTCukF4uCV57TkamyTbLzjFWcdi3S" ||
                            btcKey.getPubPoint().compressed != true) {
                            return false;
                        }
                        return true;
                    },
                    testWifToECKey: function() {
                        var key = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var btcKey = new Bitcoin.ECKey(key);
                        if (btcKey.getBitcoinWalletImportFormat() != "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb") {
                            return false;
                        }
                        return true;
                    },
                    testBrainToECKey: function() {
                        var key = "bitaddress.org unit test";
                        var bytes = Crypto.SHA256(key, {
                            asBytes: true
                        });
                        var btcKey = new Bitcoin.ECKey(bytes);
                        if (btcKey.getBitcoinWalletImportFormat() != "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb") {
                            return false;
                        }
                        return true;
                    },
                    testMini30CharsToECKey: function() {
                        var key = "SQE6yipP5oW8RBaStWoB47xsRQ8pat";
                        var btcKey = new Bitcoin.ECKey(key);
                        if (btcKey.getBitcoinWalletImportFormat() != "5JrBLQseeZdYw4jWEAHmNxGMr5fxh9NJU3fUwnv4khfKcg2rJVh") {
                            return false;
                        }
                        return true;
                    },
                    testGetECKeyFromAdding: function() {
                        var key1 = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var key2 = "SQE6yipP5oW8RBaStWoB47xsRQ8pat";
                        var ecKey = ninja.privateKey.getECKeyFromAdding(key1, key2);
                        if (ecKey.getBitcoinWalletImportFormat() != "5KAJTSqSjpsZ11KyEE3qu5PrJVjR4ZCbNxK3Nb1F637oe41m1c2") {
                            return false;
                        }
                        return true;
                    },
                    testGetECKeyFromAddingCompressed: function() {
                        var key1 = "KxbhchnQquYQ2dfSxz7rrEaQTCukF4uCV57TkamyTbLzjFWcdi3S";
                        var key2 = "L1n4cgNZAo2KwdUc15zzstvo1dcxpBw26NkrLqfDZtU9AEbPkLWu";
                        var ecKey = ninja.privateKey.getECKeyFromAdding(key1, key2);
                        if (ecKey.getBitcoinWalletImportFormat() != "L3A43j2pc2J8F2SjBNbYprPrcDpDCh8Aju8dUH65BEM2r7RFSLv4") {
                            return false;
                        }
                        return true;
                    },
                    testGetECKeyFromAddingUncompressedAndCompressed: function() {
                        var key1 = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var key2 = "L1n4cgNZAo2KwdUc15zzstvo1dcxpBw26NkrLqfDZtU9AEbPkLWu";
                        var ecKey = ninja.privateKey.getECKeyFromAdding(key1, key2);
                        if (ecKey.getBitcoinWalletImportFormat() != "5KAJTSqSjpsZ11KyEE3qu5PrJVjR4ZCbNxK3Nb1F637oe41m1c2") {
                            return false;
                        }
                        return true;
                    },
                    testGetECKeyFromAddingShouldReturnNullWhenSameKey1: function() {
                        var key1 = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var key2 = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var ecKey = ninja.privateKey.getECKeyFromAdding(key1, key2);
                        if (ecKey != null) {
                            return false;
                        }
                        return true;
                    },
                    testGetECKeyFromAddingShouldReturnNullWhenSameKey2: function() {
                        var key1 = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var key2 = "KxbhchnQquYQ2dfSxz7rrEaQTCukF4uCV57TkamyTbLzjFWcdi3S";
                        var ecKey = ninja.privateKey.getECKeyFromAdding(key1, key2);
                        if (ecKey != null) {
                            return false;
                        }
                        return true;
                    },
                    testGetECKeyFromMultiplying: function() {
                        var key1 = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var key2 = "SQE6yipP5oW8RBaStWoB47xsRQ8pat";
                        var ecKey = ninja.privateKey.getECKeyFromMultiplying(key1, key2);
                        if (ecKey.getBitcoinWalletImportFormat() != "5KetpZ5mCGagCeJnMmvo18n4iVrtPSqrpnW5RP92Gv2BQy7GPCk") {
                            return false;
                        }
                        return true;
                    },
                    testGetECKeyFromMultiplyingCompressed: function() {
                        var key1 = "KxbhchnQquYQ2dfSxz7rrEaQTCukF4uCV57TkamyTbLzjFWcdi3S";
                        var key2 = "L1n4cgNZAo2KwdUc15zzstvo1dcxpBw26NkrLqfDZtU9AEbPkLWu";
                        var ecKey = ninja.privateKey.getECKeyFromMultiplying(key1, key2);
                        if (ecKey.getBitcoinWalletImportFormat() != "L5LFitc24jme2PfVChJS3bKuQAPBp54euuqLWciQdF2CxnaU3M8t") {
                            return false;
                        }
                        return true;
                    },
                    testGetECKeyFromMultiplyingUncompressedAndCompressed: function() {
                        var key1 = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var key2 = "L1n4cgNZAo2KwdUc15zzstvo1dcxpBw26NkrLqfDZtU9AEbPkLWu";
                        var ecKey = ninja.privateKey.getECKeyFromMultiplying(key1, key2);
                        if (ecKey.getBitcoinWalletImportFormat() != "5KetpZ5mCGagCeJnMmvo18n4iVrtPSqrpnW5RP92Gv2BQy7GPCk") {
                            return false;
                        }
                        return true;
                    },
                    testGetECKeyFromMultiplyingShouldReturnNullWhenSameKey1: function() {
                        var key1 = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var key2 = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var ecKey = ninja.privateKey.getECKeyFromMultiplying(key1, key2);
                        if (ecKey != null) {
                            return false;
                        }
                        return true;
                    },
                    testGetECKeyFromMultiplyingShouldReturnNullWhenSameKey2: function() {
                        var key1 = "5J8QhiQtAiozKwyk3GCycAscg1tNaYhNdiiLey8vaDK8Bzm4znb";
                        var key2 = "KxbhchnQquYQ2dfSxz7rrEaQTCukF4uCV57TkamyTbLzjFWcdi3S";
                        var ecKey = ninja.privateKey.getECKeyFromMultiplying(key1, key2);
                        if (ecKey != null) {
                            return false;
                        }
                        return true;
                    },
                    testGetECKeyFromBase6Key: function() {
                        var baseKey = "100531114202410255230521444145414341221420541210522412225005202300434134213212540304311321323051431";
                        var hexKey = "292665C3872418ADF1DA7FFA3A646F2F0602246DA6098A91D229C32150F2718B";
                        var ecKey = new Bitcoin.ECKey(baseKey);
                        if (ecKey.getBitcoinHexFormat() != hexKey) {
                            return false;
                        }
                        return true;
                    },

                    // EllipticCurve tests
                    testDecodePointEqualsDecodeFrom: function() {
                        var key = "04F04BF260DCCC46061B5868F60FE962C77B5379698658C98A93C3129F5F98938020F36EBBDE6F1BEAF98E5BD0E425747E68B0F2FB7A2A59EDE93F43C0D78156FF";
                        var ecparams = EllipticCurve.getSECCurveByName("secp256k1");
                        var ecPoint1 = EllipticCurve.PointFp.decodeFrom(ecparams.getCurve(), Crypto.util.hexToBytes(key));
                        var ecPoint2 = ecparams.getCurve().decodePointHex(key);
                        if (!ecPoint1.equals(ecPoint2)) {
                            return false;
                        }
                        return true;
                    },
                    testDecodePointHexForCompressedPublicKey: function() {
                        var key = "03F04BF260DCCC46061B5868F60FE962C77B5379698658C98A93C3129F5F989380";
                        var pubHexUncompressed = ninja.publicKey.getDecompressedPubKeyHex(key);
                        if (pubHexUncompressed != "04F04BF260DCCC46061B5868F60FE962C77B5379698658C98A93C3129F5F98938020F36EBBDE6F1BEAF98E5BD0E425747E68B0F2FB7A2A59EDE93F43C0D78156FF") {
                            return false;
                        }
                        return true;
                    },
                    // old bugs
                    testBugWithLeadingZeroBytePublicKey: function() {
                        var key = "5Je7CkWTzgdo1RpwjYhwnVKxQXt8EPRq17WZFtWcq5umQdsDtTP";
                        var btcKey = new Bitcoin.ECKey(key);
                        if (btcKey.getBitcoinAddress() != "1M6dsMZUjFxjdwsyVk8nJytWcfr9tfUa9E") {
                            return false;
                        }
                        return true;
                    },
                    testBugWithLeadingZeroBytePrivateKey: function() {
                        var key = "0004d30da67214fa65a41a6493576944c7ea86713b14db437446c7a8df8e13da";
                        var btcKey = new Bitcoin.ECKey(key);
                        if (btcKey.getBitcoinAddress() != "1NAjZjF81YGfiJ3rTKc7jf1nmZ26KN7Gkn") {
                            return false;
                        }
                        return true;
                    }
                },

                asynchronousTests: {
                    //https://en.bitcoin.it/wiki/BIP_0038
                    testBip38: function(done) {
                        var tests = [
                            //No compression, no EC multiply
                            ["6PRVWUbkzzsbcVac2qwfssoUJAN1Xhrg6bNk8J7Nzm5H7kxEbn2Nh2ZoGg", "TestingOneTwoThree", "5KN7MzqK5wt2TP1fQCYyHBtDrXdJuXbUzm4A9rKAteGu3Qi5CVR"],
                            ["6PRNFFkZc2NZ6dJqFfhRoFNMR9Lnyj7dYGrzdgXXVMXcxoKTePPX1dWByq", "Satoshi", "5HtasZ6ofTHP6HCwTqTkLDuLQisYPah7aUnSKfC7h4hMUVw2gi5"],
                            //Compression, no EC multiply
                            ["6PYNKZ1EAgYgmQfmNVamxyXVWHzK5s6DGhwP4J5o44cvXdoY7sRzhtpUeo", "TestingOneTwoThree", "L44B5gGEpqEDRS9vVPz7QT35jcBG2r3CZwSwQ4fCewXAhAhqGVpP"],
                            ["6PYLtMnXvfG3oJde97zRyLYFZCYizPU5T3LwgdYJz1fRhh16bU7u6PPmY7", "Satoshi", "KwYgW8gcxj1JWJXhPSu4Fqwzfhp5Yfi42mdYmMa4XqK7NJxXUSK7"],
                            //EC multiply, no compression, no lot/sequence numbers
                            ["6PfQu77ygVyJLZjfvMLyhLMQbYnu5uguoJJ4kMCLqWwPEdfpwANVS76gTX", "TestingOneTwoThree", "5K4caxezwjGCGfnoPTZ8tMcJBLB7Jvyjv4xxeacadhq8nLisLR2"],
                            ["6PfLGnQs6VZnrNpmVKfjotbnQuaJK4KZoPFrAjx1JMJUa1Ft8gnf5WxfKd", "Satoshi", "5KJ51SgxWaAYR13zd9ReMhJpwrcX47xTJh2D3fGPG9CM8vkv5sH"],
                            //EC multiply, no compression, lot/sequence numbers
                            ["6PgNBNNzDkKdhkT6uJntUXwwzQV8Rr2tZcbkDcuC9DZRsS6AtHts4Ypo1j", "MOLON LABE", "5JLdxTtcTHcfYcmJsNVy1v2PMDx432JPoYcBTVVRHpPaxUrdtf8"],
                            ["6PgGWtx25kUg8QWvwuJAgorN6k9FbE25rv5dMRwu5SKMnfpfVe5mar2ngH", Crypto.charenc.UTF8.bytesToString([206, 156, 206, 159, 206, 155, 206, 169, 206, 157, 32, 206, 155, 206, 145, 206, 146, 206, 149]) /*UTF-8 characters, encoded in source so they don't get corrupted*/ , "5KMKKuUmAkiNbA3DazMQiLfDq47qs8MAEThm4yL8R2PhV1ov33D"]
                        ];

                        // running each test uses a lot of memory, which isn't freed
                        // immediately, so give the VM a little time to reclaim memory
                        function waitThenCall(callback) {
                            return function() {
                                setTimeout(callback, 10000);
                            }
                        }

                        var decryptTest = function(test, i, onComplete) {
                            ninja.privateKey.BIP38EncryptedKeyToByteArrayAsync(test[0], test[1], function(privBytes) {
                                if (privBytes.constructor == Error) {
                                    document.getElementById("asyncunittestresults").innerHTML += "fail testDecryptBip38 #" + i + ", error: " + privBytes.message + "<br/>";
                                } else {
                                    var btcKey = new Bitcoin.ECKey(privBytes);
                                    var wif = !test[2].substr(0, 1).match(/[LK]/) ? btcKey.setCompressed(false).getBitcoinWalletImportFormat() : btcKey.setCompressed(true).getBitcoinWalletImportFormat();
                                    if (wif != test[2]) {
                                        document.getElementById("asyncunittestresults").innerHTML += "fail testDecryptBip38 #" + i + "<br/>";
                                    } else {
                                        document.getElementById("asyncunittestresults").innerHTML += "pass testDecryptBip38 #" + i + "<br/>";
                                    }
                                }
                                onComplete();
                            });
                        };

                        var encryptTest = function(test, compressed, i, onComplete) {
                            ninja.privateKey.BIP38PrivateKeyToEncryptedKeyAsync(test[2], test[1], compressed, function(encryptedKey) {
                                if (encryptedKey === test[0]) {
                                    document.getElementById("asyncunittestresults").innerHTML += "pass testBip38Encrypt #" + i + "<br/>";
                                } else {
                                    document.getElementById("asyncunittestresults").innerHTML += "fail testBip38Encrypt #" + i + "<br/>";
                                    document.getElementById("asyncunittestresults").innerHTML += "expected " + test[0] + "<br/>received " + encryptedKey + "<br/>";
                                }
                                onComplete();
                            });
                        };

                        // test randomly generated encryption-decryption cycle
                        var cycleTest = function(i, compress, onComplete) {
                            // create new private key
                            var privKey = (new Bitcoin.ECKey(false)).getBitcoinWalletImportFormat();

                            // encrypt private key
                            ninja.privateKey.BIP38PrivateKeyToEncryptedKeyAsync(privKey, 'testing', compress, function(encryptedKey) {
                                // decrypt encryptedKey
                                ninja.privateKey.BIP38EncryptedKeyToByteArrayAsync(encryptedKey, 'testing', function(decryptedBytes) {
                                    var decryptedKey = (new Bitcoin.ECKey(decryptedBytes)).getBitcoinWalletImportFormat();

                                    if (decryptedKey === privKey) {
                                        document.getElementById("asyncunittestresults").innerHTML += "pass cycleBip38 test #" + i + "<br/>";
                                    } else {
                                        document.getElementById("asyncunittestresults").innerHTML += "fail cycleBip38 test #" + i + " " + privKey + "<br/>";
                                        document.getElementById("asyncunittestresults").innerHTML += "encrypted key: " + encryptedKey + "<br/>decrypted key: " + decryptedKey;
                                    }
                                    onComplete();
                                });
                            });
                        };

                        // intermediate test - create some encrypted keys from an intermediate
                        // then decrypt them to check that the private keys are recoverable
                        var intermediateTest = function(i, onComplete) {
                            var pass = Math.random().toString(36).substr(2);
                            ninja.privateKey.BIP38GenerateIntermediatePointAsync(pass, null, null, function(intermediatePoint) {
                                ninja.privateKey.BIP38GenerateECAddressAsync(intermediatePoint, false, function(address, encryptedKey) {
                                    ninja.privateKey.BIP38EncryptedKeyToByteArrayAsync(encryptedKey, pass, function(privBytes) {
                                        if (privBytes.constructor == Error) {
                                            document.getElementById("asyncunittestresults").innerHTML += "fail testBip38Intermediate #" + i + ", error: " + privBytes.message + "<br/>";
                                        } else {
                                            var btcKey = new Bitcoin.ECKey(privBytes);
                                            var btcAddress = btcKey.getBitcoinAddress();
                                            if (address !== btcKey.getBitcoinAddress()) {
                                                document.getElementById("asyncunittestresults").innerHTML += "fail testBip38Intermediate #" + i + "<br/>";
                                            } else {
                                                document.getElementById("asyncunittestresults").innerHTML += "pass testBip38Intermediate #" + i + "<br/>";
                                            }
                                        }
                                        onComplete();
                                    });
                                });
                            });
                        }

                        document.getElementById("asyncunittestresults").innerHTML += "running " + tests.length + " tests named testDecryptBip38<br/>";
                        document.getElementById("asyncunittestresults").innerHTML += "running 4 tests named testBip38Encrypt<br/>";
                        document.getElementById("asyncunittestresults").innerHTML += "running 2 tests named cycleBip38<br/>";
                        document.getElementById("asyncunittestresults").innerHTML += "running 5 tests named testBip38Intermediate<br/>";
                        ninja.runSerialized([
                            function(cb) {
                                ninja.forSerialized(0, tests.length, function(i, callback) {
                                    decryptTest(tests[i], i, waitThenCall(callback));
                                }, waitThenCall(cb));
                            },
                            function(cb) {
                                ninja.forSerialized(0, 4, function(i, callback) {
                                    // only first 4 test vectors are not EC-multiply,
                                    // compression param false for i = 1,2 and true for i = 3,4
                                    encryptTest(tests[i], i >= 2, i, waitThenCall(callback));
                                }, waitThenCall(cb));
                            },
                            function(cb) {
                                ninja.forSerialized(0, 2, function(i, callback) {
                                    cycleTest(i, i % 2 ? true : false, waitThenCall(callback));
                                }, waitThenCall(cb));
                            },
                            function(cb) {
                                ninja.forSerialized(0, 5, function(i, callback) {
                                    intermediateTest(i, waitThenCall(callback));
                                }, cb);
                            }
                        ], done);
                    }
                }
            };
        })(ninja);
    </script>

    <script type="text/javascript">
        // run unit tests
        if (ninja.getQueryString()["unittests"] == "true" || ninja.getQueryString()["unittests"] == "1") {
            ninja.unitTests.runSynchronousTests();
            // ninja.translator.showEnglishJson();
            // no need to show translations until we actually have some. 9/5/2013 - Canton
        }
        // run async unit tests
        if (ninja.getQueryString()["asyncunittests"] == "true" || ninja.getQueryString()["asyncunittests"] == "1") {
            ninja.unitTests.runAsynchronousTests();
        }
        // change language
        if (ninja.getQueryString()["culture"] != undefined) {
            ninja.translator.translate(ninja.getQueryString()["culture"]);
        }

        if (ninja.getQueryString()["showseedpool"] == "true" || ninja.getQueryString()["showseedpool"] == "1") {
            document.getElementById("seedpoolarea").style.display = "block";
        }
    </script>
    
    <script src="js/design.js"></script>

    <script type="text/javascript">
        // disable unit testing if we are not working with regular old bitcoin
        if (window.currencyName != 'Bitcoin') document.getElementById('footerlabeltests').style.display = 'none';
    </script>

</body>

</html>